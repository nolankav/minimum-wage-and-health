age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_add_3 <- svyglm(adhd ~ Effective.Minimum.Wage*low_income +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_add_4 <- svyglm(adhd ~ Effective.Minimum.Wage.2020.Dollars +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_add_5 <- svyglm(adhd ~ lag_by_1 +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_add_6 <- svyglm(adhd ~ Effective.Minimum.Wage*age_cat +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_add_7 <- svyglm(adhd ~ Effective.Minimum.Wage*race_eth_cat +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
# Models for behavioral problems
model_min_beh_1 <- svyglm(behavior ~ Effective.Minimum.Wage +
year + fipsst,
design = design_sub)
model_min_beh_2 <- svyglm(behavior ~ Effective.Minimum.Wage +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_beh_3 <- svyglm(behavior ~ Effective.Minimum.Wage*low_income +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_beh_4 <- svyglm(behavior ~ Effective.Minimum.Wage.2020.Dollars +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_beh_5 <- svyglm(behavior ~ lag_by_1 +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_beh_6 <- svyglm(behavior ~ Effective.Minimum.Wage*age_cat +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_beh_7 <- svyglm(behavior ~ Effective.Minimum.Wage*race_eth_cat +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
# Models for digestive issues
model_min_dig_1 <- svyglm(stomach_r ~ Effective.Minimum.Wage +
year + fipsst,
design = design_sub)
model_min_dig_2 <- svyglm(stomach_r ~ Effective.Minimum.Wage +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_dig_3 <- svyglm(stomach_r ~ Effective.Minimum.Wage*low_income +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_dig_4 <- svyglm(stomach_r ~ Effective.Minimum.Wage.2020.Dollars +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_dig_5 <- svyglm(stomach_r ~ lag_by_1 +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_dig_6 <- svyglm(stomach_r ~ Effective.Minimum.Wage*age_cat +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_dig_7 <- svyglm(stomach_r ~ Effective.Minimum.Wage*race_eth_cat +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
# Models for unmet health needs (any)
model_min_unm_1 <- svyglm(unmet_needs ~ Effective.Minimum.Wage +
year + fipsst,
design = design_sub)
model_min_unm_2 <- svyglm(unmet_needs ~ Effective.Minimum.Wage +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_unm_3 <- svyglm(unmet_needs ~ Effective.Minimum.Wage*low_income +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_unm_4 <- svyglm(unmet_needs ~ Effective.Minimum.Wage.2020.Dollars +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_unm_5 <- svyglm(unmet_needs ~ lag_by_1 +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_unm_6 <- svyglm(unmet_needs ~ Effective.Minimum.Wage*age_cat +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_unm_7 <- svyglm(unmet_needs ~ Effective.Minimum.Wage*race_eth_cat +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
# Models for unmet mental health needs
model_min_men_1 <- svyglm(unmet_mental ~ Effective.Minimum.Wage +
year + fipsst,
design = design_sub)
model_min_men_2 <- svyglm(unmet_mental ~ Effective.Minimum.Wage +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_men_3 <- svyglm(unmet_mental ~ Effective.Minimum.Wage*low_income +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_men_4 <- svyglm(unmet_mental ~ Effective.Minimum.Wage.2020.Dollars +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_men_5 <- svyglm(unmet_mental ~ lag_by_1 +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_men_6 <- svyglm(unmet_mental ~ Effective.Minimum.Wage*age_cat +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_men_7 <- svyglm(unmet_mental ~ Effective.Minimum.Wage*race_eth_cat +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
# Models for missing school
model_min_sch_1 <- svyglm(missed_school ~ Effective.Minimum.Wage +
year + fipsst,
design = design_sub)
model_min_sch_2 <- svyglm(missed_school ~ Effective.Minimum.Wage +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_sch_3 <- svyglm(missed_school ~ Effective.Minimum.Wage*low_income +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_sch_4 <- svyglm(missed_school ~ Effective.Minimum.Wage.2020.Dollars +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_sch_5 <- svyglm(missed_school ~ lag_by_1 +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_sch_6 <- svyglm(missed_school ~ Effective.Minimum.Wage*age_cat +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
model_min_sch_7 <- svyglm(missed_school ~ Effective.Minimum.Wage*race_eth_cat +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
colnames(interaction_vals) <- c("Outcome", "Sample", "effect", "se")
# Reorder factor variables
interaction_vals$Outcome <- factor(interaction_vals$Outcome, levels=c("Depression", "Anxiety", "ADD/ADHD", "Behavioral prob.", "Digestive issues", "Unmet health care\n(of any kind)", "Unmet health care\n(mental health)", "Missed school"))
# Extract coefficients of interest
interaction_vals <- as.data.frame(rbind(
# Depression
cbind("Depression",       "All children (unadjusted)",
model_min_dep_1$coefficients[2], SE(model_min_dep_1)[2]),
cbind("Depression",       "All children (adjusted)",
model_min_dep_2$coefficients[2], SE(model_min_dep_2)[2]),
cbind("Depression",       "Less than 200% FPL",
model_min_dep_3$coefficients[2], SE(model_min_dep_3)[2]),
cbind("Depression",       "Black or Hispanic/Latino",
model_min_dep_7$coefficients[2], SE(model_min_dep_7)[2]),
cbind("Depression",       "Adolescents, age 13-17",
model_min_dep_6$coefficients[2], SE(model_min_dep_6)[2]),
cbind("Depression",       "All children (2020 dollars)",
model_min_dep_4$coefficients[2], SE(model_min_dep_4)[2]),
cbind("Depression",       "All children (lagged wage)",
model_min_dep_5$coefficients[2], SE(model_min_dep_5)[2]),
# Anxiety
cbind("Anxiety",          "All children (unadjusted)",
model_min_anx_1$coefficients[2], SE(model_min_anx_1)[2]),
cbind("Anxiety",          "All children (adjusted)",
model_min_anx_2$coefficients[2], SE(model_min_anx_2)[2]),
cbind("Anxiety",          "Less than 200% FPL",
model_min_anx_3$coefficients[2], SE(model_min_anx_3)[2]),
cbind("Anxiety",          "Black or Hispanic/Latino",
model_min_anx_7$coefficients[2], SE(model_min_anx_7)[2]),
cbind("Anxiety",          "Adolescents, age 13-17",
model_min_anx_6$coefficients[2], SE(model_min_anx_6)[2]),
cbind("Anxiety",          "All children (2020 dollars)",
model_min_anx_4$coefficients[2], SE(model_min_anx_4)[2]),
cbind("Anxiety",          "All children (lagged wage)",
model_min_anx_5$coefficients[2], SE(model_min_anx_5)[2]),
# ADD/ADHD
cbind("ADD/ADHD",          "All children (unadjusted)",
model_min_add_1$coefficients[2], SE(model_min_add_1)[2]),
cbind("ADD/ADHD",          "All children (adjusted)",
model_min_add_2$coefficients[2], SE(model_min_add_2)[2]),
cbind("ADD/ADHD",          "Less than 200% FPL",
model_min_add_3$coefficients[2], SE(model_min_add_3)[2]),
cbind("ADD/ADHD",          "Black or Hispanic/Latino",
model_min_add_7$coefficients[2], SE(model_min_add_7)[2]),
cbind("ADD/ADHD",          "Adolescents, age 13-17",
model_min_add_6$coefficients[2], SE(model_min_add_6)[2]),
cbind("ADD/ADHD",          "All children (2020 dollars)",
model_min_add_4$coefficients[2], SE(model_min_add_4)[2]),
cbind("ADD/ADHD",          "All children (lagged wage)",
model_min_add_5$coefficients[2], SE(model_min_add_5)[2]),
# Behavioral problems
cbind("Behavioral prob.", "All children (unadjusted)",
model_min_beh_1$coefficients[2], SE(model_min_beh_1)[2]),
cbind("Behavioral prob.", "All children (adjusted)",
model_min_beh_2$coefficients[2], SE(model_min_beh_2)[2]),
cbind("Behavioral prob.", "Less than 200% FPL",
model_min_beh_3$coefficients[2], SE(model_min_beh_3)[2]),
cbind("Behavioral prob.", "Black or Hispanic/Latino",
model_min_beh_7$coefficients[2], SE(model_min_beh_7)[2]),
cbind("Behavioral prob.", "Adolescents, age 13-17",
model_min_beh_6$coefficients[2], SE(model_min_beh_6)[2]),
cbind("Behavioral prob.", "All children (2020 dollars)",
model_min_beh_4$coefficients[2], SE(model_min_beh_4)[2]),
cbind("Behavioral prob.", "All children (lagged wage)",
model_min_beh_5$coefficients[2], SE(model_min_beh_5)[2]),
# Digestive issues
cbind("Digestive issues", "All children (unadjusted)",
model_min_dig_1$coefficients[2], SE(model_min_dig_1)[2]),
cbind("Digestive issues", "All children (adjusted)",
model_min_dig_2$coefficients[2], SE(model_min_dig_2)[2]),
cbind("Digestive issues", "Less than 200% FPL",
model_min_dig_3$coefficients[2], SE(model_min_dig_3)[2]),
cbind("Digestive issues", "Black or Hispanic/Latino",
model_min_dig_7$coefficients[2], SE(model_min_dig_7)[2]),
cbind("Digestive issues", "Adolescents, age 13-17",
model_min_dig_6$coefficients[2], SE(model_min_dig_6)[2]),
cbind("Digestive issues", "All children (2020 dollars)",
model_min_dig_4$coefficients[2], SE(model_min_dig_4)[2]),
cbind("Digestive issues", "All children (lagged wage)",
model_min_dig_5$coefficients[2], SE(model_min_dig_5)[2]),
# Unmet health care needs (any)
cbind("Unmet health care\n(of any kind)", "All children (unadjusted)",
model_min_unm_1$coefficients[2], SE(model_min_unm_1)[2]),
cbind("Unmet health care\n(of any kind)", "All children (adjusted)",
model_min_unm_2$coefficients[2], SE(model_min_unm_2)[2]),
cbind("Unmet health care\n(of any kind)", "Less than 200% FPL",
model_min_unm_3$coefficients[2], SE(model_min_unm_3)[2]),
cbind("Unmet health care\n(of any kind)", "Black or Hispanic/Latino",
model_min_unm_7$coefficients[2], SE(model_min_unm_7)[2]),
cbind("Unmet health care\n(of any kind)", "Adolescents, age 13-17",
model_min_unm_6$coefficients[2], SE(model_min_unm_6)[2]),
cbind("Unmet health care\n(of any kind)", "All children (2020 dollars)",
model_min_unm_4$coefficients[2], SE(model_min_unm_4)[2]),
cbind("Unmet health care\n(of any kind)", "All children (lagged wage)",
model_min_unm_5$coefficients[2], SE(model_min_unm_5)[2]),
# Unmet mental health care
cbind("Unmet health care\n(mental health)", "All children (unadjusted)",
model_min_men_1$coefficients[2], SE(model_min_men_1)[2]),
cbind("Unmet health care\n(mental health)", "All children (adjusted)",
model_min_men_2$coefficients[2], SE(model_min_men_2)[2]),
cbind("Unmet health care\n(mental health)", "Less than 200% FPL",
model_min_men_3$coefficients[2], SE(model_min_men_3)[2]),
cbind("Unmet health care\n(mental health)", "Black or Hispanic/Latino",
model_min_men_7$coefficients[2], SE(model_min_men_7)[2]),
cbind("Unmet health care\n(mental health)", "Adolescents, age 13-17",
model_min_men_6$coefficients[2], SE(model_min_men_6)[2]),
cbind("Unmet health care\n(mental health)", "All children (2020 dollars)",
model_min_men_4$coefficients[2], SE(model_min_men_4)[2]),
cbind("Unmet health care\n(mental health)", "All children (lagged wage)",
model_min_men_5$coefficients[2], SE(model_min_men_5)[2]),
# Missed 1+ week of school
cbind("Missed school",    "All children (unadjusted)",
model_min_sch_1$coefficients[2], SE(model_min_sch_1)[2]),
cbind("Missed school",    "All children (adjusted)",
model_min_sch_2$coefficients[2], SE(model_min_sch_2)[2]),
cbind("Missed school",    "Less than 200% FPL",
model_min_sch_3$coefficients[2], SE(model_min_sch_3)[2]),
cbind("Missed school",    "Black or Hispanic/Latino",
model_min_sch_7$coefficients[2], SE(model_min_sch_7)[2]),
cbind("Missed school",    "Adolescents, age 13-17",
model_min_sch_6$coefficients[2], SE(model_min_sch_6)[2]),
cbind("Missed school",    "All children (2020 dollars)",
model_min_sch_4$coefficients[2], SE(model_min_sch_4)[2]),
cbind("Missed school",    "All children (lagged wage)",
model_min_sch_5$coefficients[2], SE(model_min_sch_5)[2])
))
colnames(interaction_vals) <- c("Outcome", "Sample", "effect", "se")
# Reorder factor variables
interaction_vals$Outcome <- factor(interaction_vals$Outcome, levels=c("Depression", "Anxiety", "ADD/ADHD", "Behavioral prob.", "Digestive issues", "Unmet health care\n(of any kind)", "Unmet health care\n(mental health)", "Missed school"))
interaction_vals$Sample <- factor(interaction_vals$Sample, levels=c("All children (unadjusted)", "All children (adjusted)", "Less than 200% FPL", "Black or Hispanic/Latino", "Adolescents, age 13-17", "All children (2020 dollars)", "All children (lagged wage)"))
# Treat columns as numeric
interaction_vals$effect <- as.numeric(interaction_vals$effect)
interaction_vals$se     <- as.numeric(interaction_vals$se)
# Generate coefficient plot
plot_int <- ggplot(interaction_vals, aes(x=Outcome, y=effect,
group=Sample, color=Sample)) +
geom_point(position = position_dodge(width=0.6), size=1, aes(shape=Sample)) +
scale_shape_manual(values = 1:nlevels(interaction_vals$Sample)) +
geom_errorbar(aes(ymin=effect-1.96*se, ymax=effect+1.96*se),
position = position_dodge(width=0.6), width=0.4) +
ylab("Effect of $1 increase in minimum wage\non mental health outcomes") +
theme_test() +
theme(legend.position = "right",
text = element_text(size = 10, face = "bold"),
axis.text.x = element_text(angle=45, hjust=1, vjust=1),
axis.title.x = element_blank(),
axis.ticks = element_blank(),
strip.background = element_blank(),
legend.title = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color="light gray", size=0.5),
panel.grid.minor.y = element_line(color="light gray", size=0.25)) +
geom_hline(yintercept=0, color="black", size=0.25) +
scale_y_continuous(limits = c(-0.025, 0.025),
breaks = c(-0.02, -0.01, 0, 0.01, 0.02),
minor_breaks = seq(-0.02, 0.02, 0.01),
labels = function(x) paste0(x*100," pp")) +
scale_color_grey(start=0, end=0.7)
# Export figure
ggsave(plot=plot_int, file="Coefficient plot.pdf", width=6.5, height=4, units='in', dpi=600)
# Generate coefficient plot
plot_int <- ggplot(interaction_vals, aes(x=Outcome, y=effect,
group=Sample, color=Sample)) +
geom_point(position = position_dodge(width=0.6), size=1, aes(shape=Sample)) +
scale_shape_manual(values = 1:nlevels(interaction_vals$Sample)) +
geom_errorbar(aes(ymin=effect-1.96*se, ymax=effect+1.96*se),
position = position_dodge(width=0.6), width=0.4) +
ylab("Effect of $1 increase in minimum wage\non mental health outcomes") +
theme_test() +
theme(legend.position = "right",
text = element_text(size = 10, face = "bold"),
axis.text.x = element_text(angle=45, hjust=1, vjust=1),
axis.title.x = element_blank(),
axis.ticks = element_blank(),
strip.background = element_blank(),
legend.title = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color="light gray", linewidth=0.5),
panel.grid.minor.y = element_line(color="light gray", linewidth=0.25)) +
geom_hline(yintercept=0, color="black", linewidth=0.25) +
scale_y_continuous(limits = c(-0.025, 0.025),
breaks = c(-0.02, -0.01, 0, 0.01, 0.02),
minor_breaks = seq(-0.02, 0.02, 0.01),
labels = function(x) paste0(x*100," pp")) +
scale_color_grey(start=0, end=0.7)
# Export figure
ggsave(plot=plot_int, file="Coefficient plot.pdf", width=6.5, height=4, units='in', dpi=600)
model_fpl_add <- svyglm(adhd ~
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
summary(model_fpl_add)
summary(svyglm(depression ~ Effective.Minimum.Wage +
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub))
summary(svyglm(depression ~ Effective.Minimum.Wage +
age + sex + race_eth + adult_edu +
year + fipsst,
design = design_sub))
prop.table(svytable(~fpl_category + adhd,          design=design_sub), 1)
# Explore adjusted associations
model_fpl_dep <- svyglm(depression ~
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
summary(model_fpl_dep)
model_fpl_anx <- svyglm(anxiety ~
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
summary(model_fpl_anx)
model_fpl_add <- svyglm(adhd ~
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
summary(model_fpl_add)
model_fpl_beh <- svyglm(behavior ~
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
summary(model_fpl_beh)
model_fpl_unm <- svyglm(unmet_needs ~
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
summary(model_fpl_unm)
model_fpl_men <- svyglm(unmet_mental ~
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
summary(model_fpl_men)
model_fpl_dig <- svyglm(stomach_r ~
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
summary(model_fpl_dig)
model_fpl_sch <- svyglm(missed_school ~
age + sex + race_eth + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
summary(model_fpl_sch)
# Generate marginal means
means_dep <- estimate_means(model_fpl_dep, at="fpl_category")
means_anx <- estimate_means(model_fpl_anx, at="fpl_category")
means_add <- estimate_means(model_fpl_add, at="fpl_category")
means_beh <- estimate_means(model_fpl_beh, at="fpl_category")
means_dig <- estimate_means(model_fpl_dig, at="fpl_category")
means_unm <- estimate_means(model_fpl_unm, at="fpl_category")
means_men <- estimate_means(model_fpl_men, at="fpl_category")
means_sch <- estimate_means(model_fpl_sch, at="fpl_category")
# Dataframe of rates
means_all <- as.data.frame(rbind(
# Depression
cbind("Depression", "Less than 100%",  means_dep$Mean[1], means_dep$SE[1]),
cbind("Depression", "100% to 199%",    means_dep$Mean[2], means_dep$SE[2]),
cbind("Depression", "200% to 299%",    means_dep$Mean[3], means_dep$SE[3]),
cbind("Depression", "300% to 399%",    means_dep$Mean[4], means_dep$SE[4]),
cbind("Depression", "400% or greater", means_dep$Mean[5], means_dep$SE[5]),
# Anxiety
cbind("Anxiety", "Less than 100%",  means_anx$Mean[1], means_anx$SE[1]),
cbind("Anxiety", "100% to 199%",    means_anx$Mean[2], means_anx$SE[2]),
cbind("Anxiety", "200% to 299%",    means_anx$Mean[3], means_anx$SE[3]),
cbind("Anxiety", "300% to 399%",    means_anx$Mean[4], means_anx$SE[4]),
cbind("Anxiety", "400% or greater", means_anx$Mean[5], means_anx$SE[5]),
# ADD/ADHD
cbind("ADD/ADHD", "Less than 100%",  means_add$Mean[1], means_add$SE[1]),
cbind("ADD/ADHD", "100% to 199%",    means_add$Mean[2], means_add$SE[2]),
cbind("ADD/ADHD", "200% to 299%",    means_add$Mean[3], means_add$SE[3]),
cbind("ADD/ADHD", "300% to 399%",    means_add$Mean[4], means_add$SE[4]),
cbind("ADD/ADHD", "400% or greater", means_add$Mean[5], means_add$SE[5]),
# Behavioral problems
cbind("Behavioral prob.", "Less than 100%",  means_beh$Mean[1], means_beh$SE[1]),
cbind("Behavioral prob.", "100% to 199%",    means_beh$Mean[2], means_beh$SE[2]),
cbind("Behavioral prob.", "200% to 299%",    means_beh$Mean[3], means_beh$SE[3]),
cbind("Behavioral prob.", "300% to 399%",    means_beh$Mean[4], means_beh$SE[4]),
cbind("Behavioral prob.", "400% or greater", means_beh$Mean[5], means_beh$SE[5]),
# Digestive issues
cbind("Digestive issues", "Less than 100%",  means_dig$Mean[1], means_dig$SE[1]),
cbind("Digestive issues", "100% to 199%",    means_dig$Mean[2], means_dig$SE[2]),
cbind("Digestive issues", "200% to 299%",    means_dig$Mean[3], means_dig$SE[3]),
cbind("Digestive issues", "300% to 399%",    means_dig$Mean[4], means_dig$SE[4]),
cbind("Digestive issues", "400% or greater", means_dig$Mean[5], means_dig$SE[5]),
# Unmet health care needs (any)
cbind("Unmet health care\n(of any kind)", "Less than 100%",  means_unm$Mean[1], means_unm$SE[1]),
cbind("Unmet health care\n(of any kind)", "100% to 199%",    means_unm$Mean[2], means_unm$SE[2]),
cbind("Unmet health care\n(of any kind)", "200% to 299%",    means_unm$Mean[3], means_unm$SE[3]),
cbind("Unmet health care\n(of any kind)", "300% to 399%",    means_unm$Mean[4], means_unm$SE[4]),
cbind("Unmet health care\n(of any kind)", "400% or greater", means_unm$Mean[5], means_unm$SE[5]),
# Unmet health care needs (mental health)
cbind("Unmet health care\n(mental health)", "Less than 100%",  means_men$Mean[1], means_men$SE[1]),
cbind("Unmet health care\n(mental health)", "100% to 199%",    means_men$Mean[2], means_men$SE[2]),
cbind("Unmet health care\n(mental health)", "200% to 299%",    means_men$Mean[3], means_men$SE[3]),
cbind("Unmet health care\n(mental health)", "300% to 399%",    means_men$Mean[4], means_men$SE[4]),
cbind("Unmet health care\n(mental health)", "400% or greater", means_men$Mean[5], means_men$SE[5]),
# Missed school
cbind("Missed school", "Less than 100%",  means_sch$Mean[1], means_sch$SE[1]),
cbind("Missed school", "100% to 199%",    means_sch$Mean[2], means_sch$SE[2]),
cbind("Missed school", "200% to 299%",    means_sch$Mean[3], means_sch$SE[3]),
cbind("Missed school", "300% to 399%",    means_sch$Mean[4], means_sch$SE[4]),
cbind("Missed school", "400% or greater", means_sch$Mean[5], means_sch$SE[5])
))
colnames(means_all) <- c("Outcome", "FPL level", "value", "se")
# Reorder factor levels
means_all$`FPL level` <- factor(means_all$`FPL level`, levels = c("Less than 100%", "100% to 199%", "200% to 299%", "300% to 399%", "400% or greater"))
means_all$Outcome <- factor(means_all$Outcome, levels = c("Depression", "Anxiety", "ADD/ADHD", "Behavioral prob.", "Digestive issues", "Unmet health care\n(of any kind)", "Unmet health care\n(mental health)", "Missed school"))
# Treat adjusted means and SEs as numeric
means_all$value <- as.numeric(as.character(means_all$value))
means_all$se    <- as.numeric(as.character(means_all$se))
# Plot means by outcome
plot_1 <- ggplot(means_all, aes(x=`FPL level`, y=value, fill=`FPL level`)) +
geom_bar(stat = "identity") +
geom_errorbar(aes(ymin=value-1.96*se, ymax=value+1.96*se), width=0.2) +
ylab("Rate of mental health outcome,\nadjusted for demographics") +
xlab("Household FPL level") +
theme_test() +
theme(legend.position = "bottom",
text = element_text(size=10, face="bold"),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
panel.grid.major.y = element_line(color="gray", size=0.5),
panel.grid.minor.y = element_line(color="gray", size=0.25),
strip.background = element_blank(),
panel.border = element_blank(),
panel.spacing = unit(0.5, "cm", data = NULL),
strip.text = element_text(size=10)) +
scale_y_continuous(labels = scales::percent,
breaks=c(0, 0.05, 0.10, 0.15)) +
scale_fill_grey(start=0.4, end=0.8, name="") +
facet_grid(~Outcome, scales="free", space="free")
print(plot_1)
# Export figure
ggsave(plot=plot_1, file="Adjusted rates of outcomes.pdf", width=10.35, height=4, units='in', dpi=600)
stage_1$coefficients[2]
# Load packages
library(readstata13)  # Dataset tools
library(dplyr)        # Analysis tools
library(psych)        # Analysis tools
library(lfe)          # Modeling tools
library(sandwich)     # Modeling tools
library(lmtest)       # Modeling tools
library(ggplot2)      # Graphing tools
library(modelsummary) # Table tools
library(knitr)        # Table tools
##############################################################################
# Dataset preparation
##############################################################################
# Set working directory
setwd("/Users/nolankavanagh/Dropbox/ECON 2115/PSET2")
