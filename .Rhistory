COLORS     = "Reversed"
)
# Export figure
ggsave(plot=plot_rob, file="Exhibits/YRBS coefficient plot, robustness.pdf",
width=7, height=4, units='in', dpi=600)
is.factor(yrbs_all_model$fipsst)
# Define complex sampling design
# Used state clusters and apply survey weights
design_yrbs <- svydesign(id=~fipsst, weights=~weight_2, data=yrbs_all_model)
# Sad or hopeless
log_min_sad_1 <- svyglm(sad_hopeless ~ Effective.Minimum.Wage +
age_year + fipsst,
design = design_yrbs, family="quasibinomial")
summary(log_min_sad_1)
log_min_sad_2 <- svyglm(sad_hopeless ~ Effective.Minimum.Wage +
age_2 + sex_2 + race_eth_2 + grade_2 +
elig_1_5 + elig_6_18 + has_eitc + federal_pct + refundable + max_bft_3 +
age_year + fipsst,
design = design_yrbs, family="quasibinomial")
# Considered suicide
log_min_con_1 <- svyglm(cons_suicide ~ Effective.Minimum.Wage +
age_year + fipsst,
design = design_yrbs, family="quasibinomial")
log_min_con_2 <- svyglm(cons_suicide ~ Effective.Minimum.Wage +
age_2 + sex_2 + race_eth_2 + grade_2 +
elig_1_5 + elig_6_18 + has_eitc + federal_pct + refundable + max_bft_3 +
age_year + fipsst,
design = design_yrbs, family="quasibinomial")
# Attempted suicide
log_min_att_1 <- svyglm(suicide_att ~ Effective.Minimum.Wage +
age_year + fipsst,
design = design_yrbs, family="quasibinomial")
log_min_att_2 <- svyglm(suicide_att ~ Effective.Minimum.Wage +
age_2 + sex_2 + race_eth_2 + grade_2 +
elig_1_5 + elig_6_18 + has_eitc + federal_pct + refundable + max_bft_3 +
age_year + fipsst,
design = design_yrbs, family="quasibinomial")
# Recent alcohol
log_min_alc_1 <- svyglm(alcohol ~ Effective.Minimum.Wage +
age_year + fipsst,
design = design_yrbs, family="quasibinomial")
log_min_alc_2 <- svyglm(alcohol ~ Effective.Minimum.Wage +
age_2 + sex_2 + race_eth_2 + grade_2 +
elig_1_5 + elig_6_18 + has_eitc + federal_pct + refundable + max_bft_3 +
age_year + fipsst,
design = design_yrbs, family="quasibinomial")
# Recent marijuana
log_min_mjn_1 <- svyglm(marijuana ~ Effective.Minimum.Wage +
age_year + fipsst,
design = design_yrbs, family="quasibinomial")
log_min_mjn_2 <- svyglm(marijuana ~ Effective.Minimum.Wage +
age_2 + sex_2 + race_eth_2 + grade_2 +
elig_1_5 + elig_6_18 + has_eitc + federal_pct + refundable + max_bft_3 +
age_year + fipsst,
design = design_yrbs, family="quasibinomial")
# Physical fight
log_min_fgt_1 <- svyglm(fight ~ Effective.Minimum.Wage +
age_year + fipsst,
design = design_yrbs, family="quasibinomial")
log_min_fgt_2 <- svyglm(fight ~ Effective.Minimum.Wage +
age_2 + sex_2 + race_eth_2 + grade_2 +
elig_1_5 + elig_6_18 + has_eitc + federal_pct + refundable + max_bft_3 +
age_year + fipsst,
design = design_yrbs, family="quasibinomial")
# Get values from models
log_df <- as.data.frame(rbind(
# Sad or hopeless
cbind("Sad or hopeless", "Symptoms", "Adolescents (FE only)",
exp(coef(log_min_sad_1))[2],
exp(confint(log_min_sad_1))[2,1],
exp(confint(log_min_sad_1))[2,2],
exp(confint(log_min_sad_1, level=0.997))[2,1],
exp(confint(log_min_sad_1, level=0.997))[2,2],
length(log_min_sad_1$residuals)),
cbind("Sad or hopeless", "Symptoms", "Adolescents (fully adjusted)",
exp(coef(log_min_sad_2))[2],
exp(confint(log_min_sad_2))[2,1],
exp(confint(log_min_sad_2))[2,2],
exp(confint(log_min_sad_2, level=0.997))[2,1],
exp(confint(log_min_sad_2, level=0.997))[2,2],
length(log_min_sad_2$residuals)),
# Considered suicide
cbind("Considered suicide", "Symptoms", "Adolescents (FE only)",
exp(coef(log_min_con_1))[2],
exp(confint(log_min_con_1))[2,1],
exp(confint(log_min_con_1))[2,2],
exp(confint(log_min_con_1, level=0.997))[2,1],
exp(confint(log_min_con_1, level=0.997))[2,2],
length(log_min_con_1$residuals)),
cbind("Considered suicide", "Symptoms", "Adolescents (fully adjusted)",
exp(coef(log_min_con_2))[2],
exp(confint(log_min_con_2))[2,1],
exp(confint(log_min_con_2))[2,2],
exp(confint(log_min_con_2, level=0.997))[2,1],
exp(confint(log_min_con_2, level=0.997))[2,2],
length(log_min_con_2$residuals)),
# Attempted suicide
cbind("Attempted suicide", "Symptoms", "Adolescents (FE only)",
exp(coef(log_min_att_1))[2],
exp(confint(log_min_att_1))[2,1],
exp(confint(log_min_att_1))[2,2],
exp(confint(log_min_att_1, level=0.997))[2,1],
exp(confint(log_min_att_1, level=0.997))[2,2],
length(log_min_att_1$residuals)),
cbind("Attempted suicide", "Symptoms", "Adolescents (fully adjusted)",
exp(coef(log_min_att_2))[2],
exp(confint(log_min_att_2))[2,1],
exp(confint(log_min_att_2))[2,2],
exp(confint(log_min_att_2, level=0.997))[2,1],
exp(confint(log_min_att_2, level=0.997))[2,2],
length(log_min_att_2$residuals)),
# Recent alcohol
cbind("Recent alcohol", "Substances", "Adolescents (FE only)",
exp(coef(log_min_alc_1))[2],
exp(confint(log_min_alc_1))[2,1],
exp(confint(log_min_alc_1))[2,2],
exp(confint(log_min_alc_1, level=0.997))[2,1],
exp(confint(log_min_alc_1, level=0.997))[2,2],
length(log_min_alc_1$residuals)),
cbind("Recent alcohol", "Substances", "Adolescents (fully adjusted)",
exp(coef(log_min_alc_2))[2],
exp(confint(log_min_alc_2))[2,1],
exp(confint(log_min_alc_2))[2,2],
exp(confint(log_min_alc_2, level=0.997))[2,1],
exp(confint(log_min_alc_2, level=0.997))[2,2],
length(log_min_alc_2$residuals)),
# Recent marijuana
cbind("Recent marijuana", "Substances", "Adolescents (FE only)",
exp(coef(log_min_mjn_1))[2],
exp(confint(log_min_mjn_1))[2,1],
exp(confint(log_min_mjn_1))[2,2],
exp(confint(log_min_mjn_1, level=0.997))[2,1],
exp(confint(log_min_mjn_1, level=0.997))[2,2],
length(log_min_mjn_1$residuals)),
cbind("Recent marijuana", "Substances", "Adolescents (fully adjusted)",
exp(coef(log_min_mjn_2))[2],
exp(confint(log_min_mjn_2))[2,1],
exp(confint(log_min_mjn_2))[2,2],
exp(confint(log_min_mjn_2, level=0.997))[2,1],
exp(confint(log_min_mjn_2, level=0.997))[2,2],
length(log_min_mjn_2$residuals)),
# Physical fight
cbind("Physical fight", "School", "Adolescents (FE only)",
exp(coef(log_min_fgt_1))[2],
exp(confint(log_min_fgt_1))[2,1],
exp(confint(log_min_fgt_1))[2,2],
exp(confint(log_min_fgt_1, level=0.997))[2,1],
exp(confint(log_min_fgt_1, level=0.997))[2,2],
length(log_min_fgt_1$residuals)),
cbind("Physical fight", "School", "Adolescents (fully adjusted)",
exp(coef(log_min_fgt_2))[2],
exp(confint(log_min_fgt_2))[2,1],
exp(confint(log_min_fgt_2))[2,2],
exp(confint(log_min_fgt_2, level=0.997))[2,1],
exp(confint(log_min_fgt_2, level=0.997))[2,2],
length(log_min_fgt_2$residuals))
))
# Name columns
colnames(log_df) <- c("Outcome", "Category", "Sample", "or",
"conf_95_low", "conf_95_high", "conf_997_low", "conf_997_high", "n")
# Reorder outcomes
log_df$Outcome <- factor(
log_df$Outcome, levels=c("Sad or hopeless", "Considered suicide", "Attempted suicide", "Recent alcohol", "Recent marijuana", "Physical fight"))
# Reorder categories
log_df$Category <- factor(
log_df$Category, levels=c("Symptoms", "Substances", "School"))
# Reorder samples
log_df$Sample <- factor(log_df$Sample, levels=c("All children (FE only)",
"All children (fully adjusted)"))
# Treat columns as numeric
log_df$or            <- as.numeric(log_df$or)
log_df$conf_95_low   <- as.numeric(log_df$conf_95_low)
log_df$conf_95_high  <- as.numeric(log_df$conf_95_high)
log_df$conf_997_low  <- as.numeric(log_df$conf_997_low)
log_df$conf_997_high <- as.numeric(log_df$conf_997_high)
log_df$n             <- as.numeric(log_df$n)
# Get min. and max. N
min(log_df$n); max(log_df$n)
# Generate coefficient plot: Logistic
plot_log <- ggplot(log_df, aes(x=Outcome, y=or, group=Sample, color=Sample)) +
geom_hline(yintercept=0, color="black", linewidth=0.25) +
geom_point(position = position_dodge(width=0.6), size=1, aes(shape=Sample)) +
scale_shape_manual(values = 1:nlevels(log_df$Sample)) +
geom_errorbar(aes(ymin=conf_95_low, ymax=conf_95_high),
position = position_dodge(width=0.6), width=0, linewidth=0.8) +
geom_errorbar(aes(ymin=conf_997_low, ymax=conf_997_high),
position = position_dodge(width=0.6), width=0.3, alpha=0.5) +
ylab("Association of $1 increase in min. wage\nwith children's mental health") +
ggtitle("Adolescents (12-18), 2001-2019") +
theme_test() +
theme(legend.position = "bottom",
text = element_text(size = 10, face = "bold"),
axis.text.x = element_text(angle=45, hjust=1, vjust=1),
axis.title.x = element_blank(),
axis.ticks = element_blank(),
strip.background = element_blank(),
legend.title = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color="light gray", linewidth=0.5),
panel.grid.minor.y = element_line(color="light gray", linewidth=0.25)) +
scale_y_continuous(trans = "log10", limits=c(0.25,4),
labels=c("0.25", "0.5", "OR = 1", "2", "4"),
breaks=c(0.25, 0.5, 1, 2, 4),
minor_breaks = seq(0.25, 10, 0.25)) +
scale_color_grey(start=0.7, end=0) +
facet_grid(~Category, scales="free", space="free_x")
# Export figure
ggsave(plot=plot_log, file="Exhibits/YRBS coefficient plot, logistic.pdf",
width=5, height=4, units='in', dpi=600)
exp(coef(log_min_fgt_1))[2]
View(log_df)
# Get values from models
log_df <- as.data.frame(rbind(
# Sad or hopeless
cbind("Sad or hopeless", "Symptoms", "Adolescents (FE only)",
exp(coef(log_min_sad_1))[2],
exp(confint(log_min_sad_1))[2,1],
exp(confint(log_min_sad_1))[2,2],
exp(confint(log_min_sad_1, level=0.997))[2,1],
exp(confint(log_min_sad_1, level=0.997))[2,2],
length(log_min_sad_1$residuals)),
cbind("Sad or hopeless", "Symptoms", "Adolescents (fully adjusted)",
exp(coef(log_min_sad_2))[2],
exp(confint(log_min_sad_2))[2,1],
exp(confint(log_min_sad_2))[2,2],
exp(confint(log_min_sad_2, level=0.997))[2,1],
exp(confint(log_min_sad_2, level=0.997))[2,2],
length(log_min_sad_2$residuals)),
# Considered suicide
cbind("Considered suicide", "Symptoms", "Adolescents (FE only)",
exp(coef(log_min_con_1))[2],
exp(confint(log_min_con_1))[2,1],
exp(confint(log_min_con_1))[2,2],
exp(confint(log_min_con_1, level=0.997))[2,1],
exp(confint(log_min_con_1, level=0.997))[2,2],
length(log_min_con_1$residuals)),
cbind("Considered suicide", "Symptoms", "Adolescents (fully adjusted)",
exp(coef(log_min_con_2))[2],
exp(confint(log_min_con_2))[2,1],
exp(confint(log_min_con_2))[2,2],
exp(confint(log_min_con_2, level=0.997))[2,1],
exp(confint(log_min_con_2, level=0.997))[2,2],
length(log_min_con_2$residuals)),
# Attempted suicide
cbind("Attempted suicide", "Symptoms", "Adolescents (FE only)",
exp(coef(log_min_att_1))[2],
exp(confint(log_min_att_1))[2,1],
exp(confint(log_min_att_1))[2,2],
exp(confint(log_min_att_1, level=0.997))[2,1],
exp(confint(log_min_att_1, level=0.997))[2,2],
length(log_min_att_1$residuals)),
cbind("Attempted suicide", "Symptoms", "Adolescents (fully adjusted)",
exp(coef(log_min_att_2))[2],
exp(confint(log_min_att_2))[2,1],
exp(confint(log_min_att_2))[2,2],
exp(confint(log_min_att_2, level=0.997))[2,1],
exp(confint(log_min_att_2, level=0.997))[2,2],
length(log_min_att_2$residuals)),
# Recent alcohol
cbind("Recent alcohol", "Substances", "Adolescents (FE only)",
exp(coef(log_min_alc_1))[2],
exp(confint(log_min_alc_1))[2,1],
exp(confint(log_min_alc_1))[2,2],
exp(confint(log_min_alc_1, level=0.997))[2,1],
exp(confint(log_min_alc_1, level=0.997))[2,2],
length(log_min_alc_1$residuals)),
cbind("Recent alcohol", "Substances", "Adolescents (fully adjusted)",
exp(coef(log_min_alc_2))[2],
exp(confint(log_min_alc_2))[2,1],
exp(confint(log_min_alc_2))[2,2],
exp(confint(log_min_alc_2, level=0.997))[2,1],
exp(confint(log_min_alc_2, level=0.997))[2,2],
length(log_min_alc_2$residuals)),
# Recent marijuana
cbind("Recent marijuana", "Substances", "Adolescents (FE only)",
exp(coef(log_min_mjn_1))[2],
exp(confint(log_min_mjn_1))[2,1],
exp(confint(log_min_mjn_1))[2,2],
exp(confint(log_min_mjn_1, level=0.997))[2,1],
exp(confint(log_min_mjn_1, level=0.997))[2,2],
length(log_min_mjn_1$residuals)),
cbind("Recent marijuana", "Substances", "Adolescents (fully adjusted)",
exp(coef(log_min_mjn_2))[2],
exp(confint(log_min_mjn_2))[2,1],
exp(confint(log_min_mjn_2))[2,2],
exp(confint(log_min_mjn_2, level=0.997))[2,1],
exp(confint(log_min_mjn_2, level=0.997))[2,2],
length(log_min_mjn_2$residuals)),
# Physical fight
cbind("Physical fight", "School", "Adolescents (FE only)",
exp(coef(log_min_fgt_1))[2],
exp(confint(log_min_fgt_1))[2,1],
exp(confint(log_min_fgt_1))[2,2],
exp(confint(log_min_fgt_1, level=0.997))[2,1],
exp(confint(log_min_fgt_1, level=0.997))[2,2],
length(log_min_fgt_1$residuals)),
cbind("Physical fight", "School", "Adolescents (fully adjusted)",
exp(coef(log_min_fgt_2))[2],
exp(confint(log_min_fgt_2))[2,1],
exp(confint(log_min_fgt_2))[2,2],
exp(confint(log_min_fgt_2, level=0.997))[2,1],
exp(confint(log_min_fgt_2, level=0.997))[2,2],
length(log_min_fgt_2$residuals))
))
# Name columns
colnames(log_df) <- c("Outcome", "Category", "Sample", "or",
"conf_95_low", "conf_95_high", "conf_997_low", "conf_997_high", "n")
# Reorder outcomes
log_df$Outcome <- factor(
log_df$Outcome, levels=c("Sad or hopeless", "Considered suicide", "Attempted suicide", "Recent alcohol", "Recent marijuana", "Physical fight"))
# Reorder categories
log_df$Category <- factor(
log_df$Category, levels=c("Symptoms", "Substances", "School"))
# Reorder samples
log_df$Sample <- factor(log_df$Sample, levels=c("Adolescents (FE only)",
"Adolescents (fully adjusted)"))
# Treat columns as numeric
log_df$or            <- as.numeric(log_df$or)
log_df$conf_95_low   <- as.numeric(log_df$conf_95_low)
log_df$conf_95_high  <- as.numeric(log_df$conf_95_high)
log_df$conf_997_low  <- as.numeric(log_df$conf_997_low)
log_df$conf_997_high <- as.numeric(log_df$conf_997_high)
log_df$n             <- as.numeric(log_df$n)
# Get min. and max. N
min(log_df$n); max(log_df$n)
# Generate coefficient plot: Logistic
plot_log <- ggplot(log_df, aes(x=Outcome, y=or, group=Sample, color=Sample)) +
geom_hline(yintercept=0, color="black", linewidth=0.25) +
geom_point(position = position_dodge(width=0.6), size=1, aes(shape=Sample)) +
scale_shape_manual(values = 1:nlevels(log_df$Sample)) +
geom_errorbar(aes(ymin=conf_95_low, ymax=conf_95_high),
position = position_dodge(width=0.6), width=0, linewidth=0.8) +
geom_errorbar(aes(ymin=conf_997_low, ymax=conf_997_high),
position = position_dodge(width=0.6), width=0.3, alpha=0.5) +
ylab("Association of $1 increase in min. wage\nwith children's mental health") +
ggtitle("Adolescents (12-18), 2001-2019") +
theme_test() +
theme(legend.position = "bottom",
text = element_text(size = 10, face = "bold"),
axis.text.x = element_text(angle=45, hjust=1, vjust=1),
axis.title.x = element_blank(),
axis.ticks = element_blank(),
strip.background = element_blank(),
legend.title = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color="light gray", linewidth=0.5),
panel.grid.minor.y = element_line(color="light gray", linewidth=0.25)) +
scale_y_continuous(trans = "log10", limits=c(0.25,4),
labels=c("0.25", "0.5", "OR = 1", "2", "4"),
breaks=c(0.25, 0.5, 1, 2, 4),
minor_breaks = seq(0.25, 10, 0.25)) +
scale_color_grey(start=0.7, end=0) +
facet_grid(~Category, scales="free", space="free_x")
# Export figure
ggsave(plot=plot_log, file="Exhibits/YRBS coefficient plot, logistic.pdf",
width=5, height=4, units='in', dpi=600)
summary(log_min_alc_1)
confint(log_min_alc_1)
se(log_min_fgt_2))[2]
names(log_min_fgt_2)
se(log_min_fgt_2)[2]
coef(log_min_fgt_1)[2,2]
log_min_fgt_1$coefficients
log_min_fgt_1$coefficients[,2]
SE(log_min_fgt_1)[2]
coef(log_min_fgt_1)[2]
SE(log_min_fgt_2)[2]
SE(log_min_sad_2)[2]
# Get values from models
log_df <- as.data.frame(rbind(
# Sad or hopeless
cbind("Sad or hopeless", "Symptoms", "Adolescents (FE only)",
coef(log_min_sad_1)[2],
SE(log_min_sad_1)[2],
length(log_min_sad_1$residuals)),
cbind("Sad or hopeless", "Symptoms", "Adolescents (fully adjusted)",
coef(log_min_sad_2)[2],
SE(log_min_sad_2)[2],
length(log_min_sad_2$residuals)),
# Considered suicide
cbind("Considered suicide", "Symptoms", "Adolescents (FE only)",
coef(log_min_con_1)[2],
SE(log_min_con_1)[2],
length(log_min_con_1$residuals)),
cbind("Considered suicide", "Symptoms", "Adolescents (fully adjusted)",
coef(log_min_con_2)[2],
SE(log_min_con_2)[2],
length(log_min_con_2$residuals)),
# Attempted suicide
cbind("Attempted suicide", "Symptoms", "Adolescents (FE only)",
coef(log_min_att_1)[2],
SE(log_min_att_1)[2],
length(log_min_att_1$residuals)),
cbind("Attempted suicide", "Symptoms", "Adolescents (fully adjusted)",
coef(log_min_att_2)[2],
SE(log_min_att_2)[2],
length(log_min_att_2$residuals)),
# Recent alcohol
cbind("Recent alcohol", "Substances", "Adolescents (FE only)",
coef(log_min_alc_1)[2],
SE(log_min_alc_1)[2],
length(log_min_alc_1$residuals)),
cbind("Recent alcohol", "Substances", "Adolescents (fully adjusted)",
coef(log_min_alc_2)[2],
SE(log_min_alc_2)[2],
length(log_min_alc_2$residuals)),
# Recent marijuana
cbind("Recent marijuana", "Substances", "Adolescents (FE only)",
coef(log_min_mjn_1)[2],
SE(log_min_mjn_1)[2],
length(log_min_mjn_1$residuals)),
cbind("Recent marijuana", "Substances", "Adolescents (fully adjusted)",
coef(log_min_mjn_2)[2],
SE(log_min_mjn_2)[2],
length(log_min_mjn_2$residuals)),
# Physical fight
cbind("Physical fight", "School", "Adolescents (FE only)",
coef(log_min_fgt_1)[2],
SE(log_min_fgt_1)[2],
length(log_min_fgt_1$residuals)),
cbind("Physical fight", "School", "Adolescents (fully adjusted)",
coef(log_min_fgt_2)[2],
SE(log_min_fgt_2)[2],
length(log_min_fgt_2$residuals))
))
View(log_df)
# Name columns
colnames(log_df) <- c("Outcome", "Category", "Sample", "log_odds", "se", "n")
summary(log_min_fgt_2)
# Name columns
colnames(log_df) <- c("Outcome", "Category", "Sample", "log_odds", "se", "n")
# Reorder outcomes
log_df$Outcome <- factor(
log_df$Outcome, levels=c("Sad or hopeless", "Considered suicide", "Attempted suicide", "Recent alcohol", "Recent marijuana", "Physical fight"))
# Reorder categories
log_df$Category <- factor(
log_df$Category, levels=c("Symptoms", "Substances", "School"))
# Reorder samples
log_df$Sample <- factor(log_df$Sample, levels=c("Adolescents (FE only)",
"Adolescents (fully adjusted)"))
# Treat columns as numeric
log_df$log_odds <- as.numeric(log_df$log_odds)
log_df$se       <- as.numeric(log_df$se)
log_df$n        <- as.numeric(log_df$n)
# Get min. and max. N
min(log_df$n); max(log_df$n)
# Generate coefficient plot: Logistic
plot_log <- ggplot(log_df, aes(x=Outcome, y=exp(or), group=Sample, color=Sample)) +
geom_hline(yintercept=0, color="black", linewidth=0.25) +
geom_point(position = position_dodge(width=0.6), size=1, aes(shape=Sample)) +
scale_shape_manual(values = 1:nlevels(log_df$Sample)) +
geom_errorbar(aes(ymin=exp(or - 1.96*se), ymax=exp(or + 1.96*se)),
position = position_dodge(width=0.6), width=0, linewidth=0.8) +
geom_errorbar(aes(ymin=exp(or - 2.94*se), ymax=exp(or + 2.94*se)),
position = position_dodge(width=0.6), width=0.3, alpha=0.5) +
ylab("Association of $1 increase in min. wage\nwith children's mental health") +
ggtitle("Adolescents (12-18), 2001-2019") +
theme_test() +
theme(legend.position = "bottom",
text = element_text(size = 10, face = "bold"),
axis.text.x = element_text(angle=45, hjust=1, vjust=1),
axis.title.x = element_blank(),
axis.ticks = element_blank(),
strip.background = element_blank(),
legend.title = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color="light gray", linewidth=0.5),
panel.grid.minor.y = element_line(color="light gray", linewidth=0.25)) +
scale_y_continuous(trans = "log10", limits=c(0.25,4),
labels=c("0.25", "0.5", "OR = 1", "2", "4"),
breaks=c(0.25, 0.5, 1, 2, 4),
minor_breaks = seq(0.25, 10, 0.25)) +
scale_color_grey(start=0.7, end=0) +
facet_grid(~Category, scales="free", space="free_x")
# Export figure
ggsave(plot=plot_log, file="Exhibits/YRBS coefficient plot, logistic.pdf",
width=5, height=4, units='in', dpi=600)
# Generate coefficient plot: Logistic
plot_log <- ggplot(log_df, aes(x=Outcome, y=exp(log_odds), group=Sample, color=Sample)) +
geom_hline(yintercept=0, color="black", linewidth=0.25) +
geom_point(position = position_dodge(width=0.6), size=1, aes(shape=Sample)) +
scale_shape_manual(values = 1:nlevels(log_df$Sample)) +
geom_errorbar(aes(ymin=exp(log_odds - 1.96*se), ymax=exp(log_odds + 1.96*se)),
position = position_dodge(width=0.6), width=0, linewidth=0.8) +
geom_errorbar(aes(ymin=exp(log_odds - 2.94*se), ymax=exp(log_odds + 2.94*se)),
position = position_dodge(width=0.6), width=0.3, alpha=0.5) +
ylab("Association of $1 increase in min. wage\nwith children's mental health") +
ggtitle("Adolescents (12-18), 2001-2019") +
theme_test() +
theme(legend.position = "bottom",
text = element_text(size = 10, face = "bold"),
axis.text.x = element_text(angle=45, hjust=1, vjust=1),
axis.title.x = element_blank(),
axis.ticks = element_blank(),
strip.background = element_blank(),
legend.title = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color="light gray", linewidth=0.5),
panel.grid.minor.y = element_line(color="light gray", linewidth=0.25)) +
scale_y_continuous(trans = "log10", limits=c(0.25,4),
labels=c("0.25", "0.5", "OR = 1", "2", "4"),
breaks=c(0.25, 0.5, 1, 2, 4),
minor_breaks = seq(0.25, 10, 0.25)) +
scale_color_grey(start=0.7, end=0) +
facet_grid(~Category, scales="free", space="free_x")
# Export figure
ggsave(plot=plot_log, file="Exhibits/YRBS coefficient plot, logistic.pdf",
width=5, height=4, units='in', dpi=600)
?svydesign
# fit the logistic regression
fit = glm(sad_hopeless ~ Effective.Minimum.Wage +
age_year + fipsst, data = yrbs_all_model, family = binomial)
