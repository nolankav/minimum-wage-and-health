# Extract coefficients of interest
main_vals <- as.data.frame(rbind(
# # Depression
# cbind("Depression",       "All children (unadjusted)",
#       model_min_dep_1$coefficients[2], SE(model_min_dep_1)[2]),
# cbind("Depression",       "All children (adjusted)",
#       model_min_dep_2$coefficients[2], SE(model_min_dep_2)[2]),
# cbind("Depression",       "Less than 200% FPL",
#       model_min_dep_3$coefficients[2], SE(model_min_dep_3)[2]),
# cbind("Depression",       "Adults with high school or less",
#       model_min_dep_8$coefficients[2], SE(model_min_dep_8)[2]),
# cbind("Depression",       "Black or Hispanic/Latino",
#       model_min_dep_7$coefficients[2], SE(model_min_dep_7)[2]),
# cbind("Depression",       "First- or second-generation",
#       model_min_dep_9$coefficients[2], SE(model_min_dep_9)[2]),
# cbind("Depression",       "Adolescents, age 13-17",
#       model_min_dep_6$coefficients[2], SE(model_min_dep_6)[2]),
# cbind("Depression",       "All children (2020 dollars)",
#       model_min_dep_4$coefficients[2], SE(model_min_dep_4)[2]),
# cbind("Depression",       "All children (lagged wage)",
#       model_min_dep_5$coefficients[2], SE(model_min_dep_5)[2]),
#
# # Anxiety
# cbind("Anxiety",          "All children (unadjusted)",
#       model_min_anx_1$coefficients[2], SE(model_min_anx_1)[2]),
# cbind("Anxiety",          "All children (adjusted)",
#       model_min_anx_2$coefficients[2], SE(model_min_anx_2)[2]),
# cbind("Anxiety",          "Less than 200% FPL",
#       model_min_anx_3$coefficients[2], SE(model_min_anx_3)[2]),
# cbind("Anxiety",          "Adults with high school or less",
#       model_min_anx_8$coefficients[2], SE(model_min_anx_8)[2]),
# cbind("Anxiety",          "Black or Hispanic/Latino",
#       model_min_anx_7$coefficients[2], SE(model_min_anx_7)[2]),
# cbind("Anxiety",          "First- or second-generation",
#       model_min_anx_9$coefficients[2], SE(model_min_anx_9)[2]),
# cbind("Anxiety",          "Adolescents, age 13-17",
#       model_min_anx_6$coefficients[2], SE(model_min_anx_6)[2]),
# cbind("Anxiety",          "All children (2020 dollars)",
#       model_min_anx_4$coefficients[2], SE(model_min_anx_4)[2]),
# cbind("Anxiety",          "All children (lagged wage)",
#       model_min_anx_5$coefficients[2], SE(model_min_anx_5)[2]),
#
# # ADD/ADHD
# cbind("ADD/ADHD",          "All children (unadjusted)",
#       model_min_add_1$coefficients[2], SE(model_min_add_1)[2]),
# cbind("ADD/ADHD",          "All children (adjusted)",
#       model_min_add_2$coefficients[2], SE(model_min_add_2)[2]),
# cbind("ADD/ADHD",          "Less than 200% FPL",
#       model_min_add_3$coefficients[2], SE(model_min_add_3)[2]),
# cbind("ADD/ADHD",          "Adults with high school or less",
#       model_min_add_8$coefficients[2], SE(model_min_add_8)[2]),
# cbind("ADD/ADHD",          "Black or Hispanic/Latino",
#       model_min_add_7$coefficients[2], SE(model_min_add_7)[2]),
# cbind("ADD/ADHD",          "First- or second-generation",
#       model_min_add_9$coefficients[2], SE(model_min_add_9)[2]),
# cbind("ADD/ADHD",          "Adolescents, age 13-17",
#       model_min_add_6$coefficients[2], SE(model_min_add_6)[2]),
# cbind("ADD/ADHD",          "All children (2020 dollars)",
#       model_min_add_4$coefficients[2], SE(model_min_add_4)[2]),
# cbind("ADD/ADHD",          "All children (lagged wage)",
#       model_min_add_5$coefficients[2], SE(model_min_add_5)[2]),
#
# # Behavioral problems
# cbind("Behavioral prob.", "All children (unadjusted)",
#       model_min_beh_1$coefficients[2], SE(model_min_beh_1)[2]),
# cbind("Behavioral prob.", "All children (adjusted)",
#       model_min_beh_2$coefficients[2], SE(model_min_beh_2)[2]),
# cbind("Behavioral prob.", "Less than 200% FPL",
#       model_min_beh_3$coefficients[2], SE(model_min_beh_3)[2]),
# cbind("Behavioral prob.", "Adults with high school or less",
#       model_min_beh_8$coefficients[2], SE(model_min_beh_8)[2]),
# cbind("Behavioral prob.", "Black or Hispanic/Latino",
#       model_min_beh_7$coefficients[2], SE(model_min_beh_7)[2]),
# cbind("Behavioral prob.", "First- or second-generation",
#       model_min_beh_9$coefficients[2], SE(model_min_beh_9)[2]),
# cbind("Behavioral prob.", "Adolescents, age 13-17",
#       model_min_beh_6$coefficients[2], SE(model_min_beh_6)[2]),
# cbind("Behavioral prob.", "All children (2020 dollars)",
#       model_min_beh_4$coefficients[2], SE(model_min_beh_4)[2]),
# cbind("Behavioral prob.", "All children (lagged wage)",
#       model_min_beh_5$coefficients[2], SE(model_min_beh_5)[2]),
#
# # Digestive issues
# cbind("Digestive issues", "All children (unadjusted)",
#       model_min_dig_1$coefficients[2], SE(model_min_dig_1)[2]),
# cbind("Digestive issues", "All children (adjusted)",
#       model_min_dig_2$coefficients[2], SE(model_min_dig_2)[2]),
# cbind("Digestive issues", "Less than 200% FPL",
#       model_min_dig_3$coefficients[2], SE(model_min_dig_3)[2]),
# cbind("Digestive issues", "Adults with high school or less",
#       model_min_dig_8$coefficients[2], SE(model_min_dig_8)[2]),
# cbind("Digestive issues", "Black or Hispanic/Latino",
#       model_min_dig_7$coefficients[2], SE(model_min_dig_7)[2]),
# cbind("Digestive issues", "First- or second-generation",
#       model_min_dig_9$coefficients[2], SE(model_min_dig_9)[2]),
# cbind("Digestive issues", "Adolescents, age 13-17",
#       model_min_dig_6$coefficients[2], SE(model_min_dig_6)[2]),
# cbind("Digestive issues", "All children (2020 dollars)",
#       model_min_dig_4$coefficients[2], SE(model_min_dig_4)[2]),
# cbind("Digestive issues", "All children (lagged wage)",
#       model_min_dig_5$coefficients[2], SE(model_min_dig_5)[2]),
#
# # Unmet health care needs (any)
# cbind("Unmet health care\n(of any kind)", "All children (unadjusted)",
#       model_min_unm_1$coefficients[2], SE(model_min_unm_1)[2]),
# cbind("Unmet health care\n(of any kind)", "All children (adjusted)",
#       model_min_unm_2$coefficients[2], SE(model_min_unm_2)[2]),
# cbind("Unmet health care\n(of any kind)", "Less than 200% FPL",
#       model_min_unm_3$coefficients[2], SE(model_min_unm_3)[2]),
# cbind("Unmet health care\n(of any kind)", "Adults with high school or less",
#       model_min_unm_8$coefficients[2], SE(model_min_unm_8)[2]),
# cbind("Unmet health care\n(of any kind)", "Black or Hispanic/Latino",
#       model_min_unm_7$coefficients[2], SE(model_min_unm_7)[2]),
# cbind("Unmet health care\n(of any kind)", "First- or second-generation",
#       model_min_unm_9$coefficients[2], SE(model_min_unm_9)[2]),
# cbind("Unmet health care\n(of any kind)", "Adolescents, age 13-17",
#       model_min_unm_6$coefficients[2], SE(model_min_unm_6)[2]),
# cbind("Unmet health care\n(of any kind)", "All children (2020 dollars)",
#       model_min_unm_4$coefficients[2], SE(model_min_unm_4)[2]),
# cbind("Unmet health care\n(of any kind)", "All children (lagged wage)",
#       model_min_unm_5$coefficients[2], SE(model_min_unm_5)[2]),
#
# # Unmet mental health care
# cbind("Unmet health care\n(mental health)", "All children (unadjusted)",
#       model_min_men_1$coefficients[2], SE(model_min_men_1)[2]),
# cbind("Unmet health care\n(mental health)", "All children (adjusted)",
#       model_min_men_2$coefficients[2], SE(model_min_men_2)[2]),
# cbind("Unmet health care\n(mental health)", "Less than 200% FPL",
#       model_min_men_3$coefficients[2], SE(model_min_men_3)[2]),
# cbind("Unmet health care\n(mental health)", "Adults with high school or less",
#       model_min_men_8$coefficients[2], SE(model_min_men_8)[2]),
# cbind("Unmet health care\n(mental health)", "Black or Hispanic/Latino",
#       model_min_men_7$coefficients[2], SE(model_min_men_7)[2]),
# cbind("Unmet health care\n(mental health)", "First- or second-generation",
#       model_min_men_9$coefficients[2], SE(model_min_men_9)[2]),
# cbind("Unmet health care\n(mental health)", "Adolescents, age 13-17",
#       model_min_men_6$coefficients[2], SE(model_min_men_6)[2]),
# cbind("Unmet health care\n(mental health)", "All children (2020 dollars)",
#       model_min_men_4$coefficients[2], SE(model_min_men_4)[2]),
# cbind("Unmet health care\n(mental health)", "All children (lagged wage)",
#       model_min_men_5$coefficients[2], SE(model_min_men_5)[2]),
#
# # Missed 1+ week of school
# cbind("Missed school",    "All children (unadjusted)",
#       model_min_sch_1$coefficients[2], SE(model_min_sch_1)[2]),
# cbind("Missed school",    "All children (adjusted)",
#       model_min_sch_2$coefficients[2], SE(model_min_sch_2)[2]),
# cbind("Missed school",    "Less than 200% FPL",
#       model_min_sch_3$coefficients[2], SE(model_min_sch_3)[2]),
# cbind("Missed school",    "Adults with high school or less",
#       model_min_sch_8$coefficients[2], SE(model_min_sch_8)[2]),
# cbind("Missed school",    "Black or Hispanic/Latino",
#       model_min_sch_7$coefficients[2], SE(model_min_sch_7)[2]),
# cbind("Missed school",    "First- or second-generation",
#       model_min_sch_9$coefficients[2], SE(model_min_sch_9)[2]),
# cbind("Missed school",    "Adolescents, age 13-17",
#       model_min_sch_6$coefficients[2], SE(model_min_sch_6)[2]),
# cbind("Missed school",    "All children (2020 dollars)",
#       model_min_sch_4$coefficients[2], SE(model_min_sch_4)[2]),
# cbind("Missed school",    "All children (lagged wage)",
#       model_min_sch_5$coefficients[2], SE(model_min_sch_5)[2]),
# Child employment
cbind("Child employed",    "All children (unadjusted)",
model_min_job_1$coefficients[2], SE(model_min_job_1)[2]),
cbind("Child employed",    "All children (adjusted)",
model_min_job_2$coefficients[2], SE(model_min_job_2)[2]),
cbind("Child employed",    "Less than 200% FPL",
model_min_job_3$coefficients[2], SE(model_min_job_3)[2]),
cbind("Child employed",    "Adults with high school or less",
model_min_job_8$coefficients[2], SE(model_min_job_8)[2]),
cbind("Child employed",    "Black or Hispanic/Latino",
model_min_job_7$coefficients[2], SE(model_min_job_7)[2]),
cbind("Child employed",    "First- or second-generation",
model_min_job_9$coefficients[2], SE(model_min_job_9)[2]),
cbind("Child employed",    "Adolescents, age 13-17",
model_min_job_6$coefficients[2], SE(model_min_job_6)[2]),
cbind("Child employed",    "All children (2020 dollars)",
model_min_job_4$coefficients[2], SE(model_min_job_4)[2]),
cbind("Child employed",    "All children (lagged wage)",
model_min_job_5$coefficients[2], SE(model_min_job_5)[2])
))
colnames(main_vals) <- c("Outcome", "Sample", "effect", "se")
# Reorder factor variables
main_vals$Outcome <- factor(main_vals$Outcome, levels=c("Depression", "Anxiety", "ADD/ADHD", "Behavioral prob.", "Digestive issues", "Unmet health care\n(of any kind)", "Unmet health care\n(mental health)", "Missed school", "Child employed"))
main_vals$Sample <- factor(main_vals$Sample, levels=c("All children (unadjusted)", "All children (adjusted)", "Less than 200% FPL", "Adults with high school or less", "Black or Hispanic/Latino", "First- or second-generation", "Adolescents, age 13-17", "All children (2020 dollars)", "All children (lagged wage)"))
# Treat columns as numeric
main_vals$effect <- as.numeric(main_vals$effect)
main_vals$se     <- as.numeric(main_vals$se)
# Generate coefficient plot
plot_main <- ggplot(main_vals, aes(x=Outcome, y=effect,
group=Sample, color=Sample)) +
geom_point(position = position_dodge(width=0.6), size=1, aes(shape=Sample)) +
scale_shape_manual(values = 1:nlevels(main_vals$Sample)) +
geom_errorbar(aes(ymin=effect-1.96*se, ymax=effect+1.96*se),
position = position_dodge(width=0.6), width=0.4) +
ylab("Effect of $1 increase in minimum wage\non mental health outcomes") +
theme_test() +
theme(legend.position = "right",
text = element_text(size = 10, face = "bold"),
axis.text.x = element_text(angle=45, hjust=1, vjust=1),
axis.title.x = element_blank(),
axis.ticks = element_blank(),
strip.background = element_blank(),
legend.title = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color="light gray", linewidth=0.5),
panel.grid.minor.y = element_line(color="light gray", linewidth=0.25)) +
geom_hline(yintercept=0, color="black", linewidth=0.25) +
scale_y_continuous(limits = c(-0.05, 0.05),
breaks = seq(-0.04, 0.04, 0.02),
minor_breaks = seq(-0.05, 0.05, 0.01),
labels = function(x) paste0(x*100," pp")) +
scale_color_grey(start=0, end=0.7)
# Export figure
ggsave(plot=plot_main, file="Coefficient plot, main.pdf", width=8, height=4, units='in', dpi=600)
# Export figure
ggsave(plot=plot_main, file="Coefficient plot, main.pdf", width=4, height=4, units='in', dpi=600)
# Models for child employment
model_min_job_1 <- svyglm(child_job ~ Effective.Minimum.Wage +
year + fipsst,
design = design_sub)
model_min_job_2 <- svyglm(child_job ~ Effective.Minimum.Wage +
age + sex + race_eth + family_struc + adult_edu + nativity +
year + fipsst,
design = design_sub)
model_min_job_3 <- svyglm(child_job ~ Effective.Minimum.Wage*low_income +
age + sex + race_eth + family_struc + adult_edu + nativity +
year + fipsst,
design = design_sub)
model_min_job_4 <- svyglm(child_job ~ Effective.Minimum.Wage.2020.Dollars +
age + sex + race_eth + family_struc + adult_edu + nativity +
year + fipsst,
design = design_sub)
model_min_job_5 <- svyglm(child_job ~ lag_by_1 +
age + sex + race_eth + family_struc + adult_edu + nativity +
year + fipsst,
design = design_sub)
model_min_job_6 <- svyglm(child_job ~ Effective.Minimum.Wage*age_cat +
age + sex + race_eth + family_struc + adult_edu + nativity +
year + fipsst,
design = design_sub)
model_min_job_7 <- svyglm(child_job ~ Effective.Minimum.Wage*race_eth_cat +
age + sex + race_eth + family_struc + adult_edu + nativity +
year + fipsst,
design = design_sub)
model_min_job_8 <- svyglm(child_job ~ Effective.Minimum.Wage*adult_edu_cat +
age + sex + race_eth + family_struc + adult_edu + nativity +
year + fipsst,
design = design_sub)
model_min_job_9 <- svyglm(child_job ~ Effective.Minimum.Wage*nativity_cat +
age + sex + race_eth + family_struc + adult_edu + nativity +
year + fipsst,
design = design_sub)
# Get range of sample sizes
list <- cbind(
# Depression
length(model_min_dep_1$residuals), length(model_min_dep_2$residuals),
length(model_min_dep_3$residuals), length(model_min_dep_4$residuals),
length(model_min_dep_5$residuals), length(model_min_dep_6$residuals),
length(model_min_dep_7$residuals),
# Anxiety
length(model_min_anx_1$residuals), length(model_min_anx_2$residuals),
length(model_min_anx_3$residuals), length(model_min_anx_4$residuals),
length(model_min_anx_5$residuals), length(model_min_anx_6$residuals),
length(model_min_anx_7$residuals),
# Behavioral problems
length(model_min_beh_1$residuals), length(model_min_beh_2$residuals),
length(model_min_beh_3$residuals), length(model_min_beh_4$residuals),
length(model_min_beh_5$residuals), length(model_min_beh_6$residuals),
length(model_min_beh_7$residuals),
# Digestive issues
length(model_min_dig_1$residuals), length(model_min_dig_2$residuals),
length(model_min_dig_3$residuals), length(model_min_dig_4$residuals),
length(model_min_dig_5$residuals), length(model_min_dig_6$residuals),
length(model_min_dig_7$residuals),
# Missed school
length(model_min_sch_1$residuals), length(model_min_sch_2$residuals),
length(model_min_sch_3$residuals), length(model_min_sch_4$residuals),
length(model_min_sch_5$residuals), length(model_min_sch_6$residuals),
length(model_min_sch_7$residuals)
)
test <- svyglm(child_job ~ Effective.Minimum.Wage +
age + sex + race_eth + family_struc + adult_edu + nativity +
year + fipsst,
design = subset(design_sub, age %in% c(13:17)))
summary(test)
# Extract coefficients of interest
main_vals <- as.data.frame(rbind(
# # Depression
# cbind("Depression",       "All children (unadjusted)",
#       model_min_dep_1$coefficients[2], SE(model_min_dep_1)[2]),
# cbind("Depression",       "All children (adjusted)",
#       model_min_dep_2$coefficients[2], SE(model_min_dep_2)[2]),
# cbind("Depression",       "Less than 200% FPL",
#       model_min_dep_3$coefficients[2], SE(model_min_dep_3)[2]),
# cbind("Depression",       "Adults with high school or less",
#       model_min_dep_8$coefficients[2], SE(model_min_dep_8)[2]),
# cbind("Depression",       "Black or Hispanic/Latino",
#       model_min_dep_7$coefficients[2], SE(model_min_dep_7)[2]),
# cbind("Depression",       "First- or second-generation",
#       model_min_dep_9$coefficients[2], SE(model_min_dep_9)[2]),
# cbind("Depression",       "Adolescents, age 13-17",
#       model_min_dep_6$coefficients[2], SE(model_min_dep_6)[2]),
# cbind("Depression",       "All children (2020 dollars)",
#       model_min_dep_4$coefficients[2], SE(model_min_dep_4)[2]),
# cbind("Depression",       "All children (lagged wage)",
#       model_min_dep_5$coefficients[2], SE(model_min_dep_5)[2]),
#
# # Anxiety
# cbind("Anxiety",          "All children (unadjusted)",
#       model_min_anx_1$coefficients[2], SE(model_min_anx_1)[2]),
# cbind("Anxiety",          "All children (adjusted)",
#       model_min_anx_2$coefficients[2], SE(model_min_anx_2)[2]),
# cbind("Anxiety",          "Less than 200% FPL",
#       model_min_anx_3$coefficients[2], SE(model_min_anx_3)[2]),
# cbind("Anxiety",          "Adults with high school or less",
#       model_min_anx_8$coefficients[2], SE(model_min_anx_8)[2]),
# cbind("Anxiety",          "Black or Hispanic/Latino",
#       model_min_anx_7$coefficients[2], SE(model_min_anx_7)[2]),
# cbind("Anxiety",          "First- or second-generation",
#       model_min_anx_9$coefficients[2], SE(model_min_anx_9)[2]),
# cbind("Anxiety",          "Adolescents, age 13-17",
#       model_min_anx_6$coefficients[2], SE(model_min_anx_6)[2]),
# cbind("Anxiety",          "All children (2020 dollars)",
#       model_min_anx_4$coefficients[2], SE(model_min_anx_4)[2]),
# cbind("Anxiety",          "All children (lagged wage)",
#       model_min_anx_5$coefficients[2], SE(model_min_anx_5)[2]),
#
# # ADD/ADHD
# cbind("ADD/ADHD",          "All children (unadjusted)",
#       model_min_add_1$coefficients[2], SE(model_min_add_1)[2]),
# cbind("ADD/ADHD",          "All children (adjusted)",
#       model_min_add_2$coefficients[2], SE(model_min_add_2)[2]),
# cbind("ADD/ADHD",          "Less than 200% FPL",
#       model_min_add_3$coefficients[2], SE(model_min_add_3)[2]),
# cbind("ADD/ADHD",          "Adults with high school or less",
#       model_min_add_8$coefficients[2], SE(model_min_add_8)[2]),
# cbind("ADD/ADHD",          "Black or Hispanic/Latino",
#       model_min_add_7$coefficients[2], SE(model_min_add_7)[2]),
# cbind("ADD/ADHD",          "First- or second-generation",
#       model_min_add_9$coefficients[2], SE(model_min_add_9)[2]),
# cbind("ADD/ADHD",          "Adolescents, age 13-17",
#       model_min_add_6$coefficients[2], SE(model_min_add_6)[2]),
# cbind("ADD/ADHD",          "All children (2020 dollars)",
#       model_min_add_4$coefficients[2], SE(model_min_add_4)[2]),
# cbind("ADD/ADHD",          "All children (lagged wage)",
#       model_min_add_5$coefficients[2], SE(model_min_add_5)[2]),
#
# # Behavioral problems
# cbind("Behavioral prob.", "All children (unadjusted)",
#       model_min_beh_1$coefficients[2], SE(model_min_beh_1)[2]),
# cbind("Behavioral prob.", "All children (adjusted)",
#       model_min_beh_2$coefficients[2], SE(model_min_beh_2)[2]),
# cbind("Behavioral prob.", "Less than 200% FPL",
#       model_min_beh_3$coefficients[2], SE(model_min_beh_3)[2]),
# cbind("Behavioral prob.", "Adults with high school or less",
#       model_min_beh_8$coefficients[2], SE(model_min_beh_8)[2]),
# cbind("Behavioral prob.", "Black or Hispanic/Latino",
#       model_min_beh_7$coefficients[2], SE(model_min_beh_7)[2]),
# cbind("Behavioral prob.", "First- or second-generation",
#       model_min_beh_9$coefficients[2], SE(model_min_beh_9)[2]),
# cbind("Behavioral prob.", "Adolescents, age 13-17",
#       model_min_beh_6$coefficients[2], SE(model_min_beh_6)[2]),
# cbind("Behavioral prob.", "All children (2020 dollars)",
#       model_min_beh_4$coefficients[2], SE(model_min_beh_4)[2]),
# cbind("Behavioral prob.", "All children (lagged wage)",
#       model_min_beh_5$coefficients[2], SE(model_min_beh_5)[2]),
#
# # Digestive issues
# cbind("Digestive issues", "All children (unadjusted)",
#       model_min_dig_1$coefficients[2], SE(model_min_dig_1)[2]),
# cbind("Digestive issues", "All children (adjusted)",
#       model_min_dig_2$coefficients[2], SE(model_min_dig_2)[2]),
# cbind("Digestive issues", "Less than 200% FPL",
#       model_min_dig_3$coefficients[2], SE(model_min_dig_3)[2]),
# cbind("Digestive issues", "Adults with high school or less",
#       model_min_dig_8$coefficients[2], SE(model_min_dig_8)[2]),
# cbind("Digestive issues", "Black or Hispanic/Latino",
#       model_min_dig_7$coefficients[2], SE(model_min_dig_7)[2]),
# cbind("Digestive issues", "First- or second-generation",
#       model_min_dig_9$coefficients[2], SE(model_min_dig_9)[2]),
# cbind("Digestive issues", "Adolescents, age 13-17",
#       model_min_dig_6$coefficients[2], SE(model_min_dig_6)[2]),
# cbind("Digestive issues", "All children (2020 dollars)",
#       model_min_dig_4$coefficients[2], SE(model_min_dig_4)[2]),
# cbind("Digestive issues", "All children (lagged wage)",
#       model_min_dig_5$coefficients[2], SE(model_min_dig_5)[2]),
#
# # Unmet health care needs (any)
# cbind("Unmet health care\n(of any kind)", "All children (unadjusted)",
#       model_min_unm_1$coefficients[2], SE(model_min_unm_1)[2]),
# cbind("Unmet health care\n(of any kind)", "All children (adjusted)",
#       model_min_unm_2$coefficients[2], SE(model_min_unm_2)[2]),
# cbind("Unmet health care\n(of any kind)", "Less than 200% FPL",
#       model_min_unm_3$coefficients[2], SE(model_min_unm_3)[2]),
# cbind("Unmet health care\n(of any kind)", "Adults with high school or less",
#       model_min_unm_8$coefficients[2], SE(model_min_unm_8)[2]),
# cbind("Unmet health care\n(of any kind)", "Black or Hispanic/Latino",
#       model_min_unm_7$coefficients[2], SE(model_min_unm_7)[2]),
# cbind("Unmet health care\n(of any kind)", "First- or second-generation",
#       model_min_unm_9$coefficients[2], SE(model_min_unm_9)[2]),
# cbind("Unmet health care\n(of any kind)", "Adolescents, age 13-17",
#       model_min_unm_6$coefficients[2], SE(model_min_unm_6)[2]),
# cbind("Unmet health care\n(of any kind)", "All children (2020 dollars)",
#       model_min_unm_4$coefficients[2], SE(model_min_unm_4)[2]),
# cbind("Unmet health care\n(of any kind)", "All children (lagged wage)",
#       model_min_unm_5$coefficients[2], SE(model_min_unm_5)[2]),
#
# # Unmet mental health care
# cbind("Unmet health care\n(mental health)", "All children (unadjusted)",
#       model_min_men_1$coefficients[2], SE(model_min_men_1)[2]),
# cbind("Unmet health care\n(mental health)", "All children (adjusted)",
#       model_min_men_2$coefficients[2], SE(model_min_men_2)[2]),
# cbind("Unmet health care\n(mental health)", "Less than 200% FPL",
#       model_min_men_3$coefficients[2], SE(model_min_men_3)[2]),
# cbind("Unmet health care\n(mental health)", "Adults with high school or less",
#       model_min_men_8$coefficients[2], SE(model_min_men_8)[2]),
# cbind("Unmet health care\n(mental health)", "Black or Hispanic/Latino",
#       model_min_men_7$coefficients[2], SE(model_min_men_7)[2]),
# cbind("Unmet health care\n(mental health)", "First- or second-generation",
#       model_min_men_9$coefficients[2], SE(model_min_men_9)[2]),
# cbind("Unmet health care\n(mental health)", "Adolescents, age 13-17",
#       model_min_men_6$coefficients[2], SE(model_min_men_6)[2]),
# cbind("Unmet health care\n(mental health)", "All children (2020 dollars)",
#       model_min_men_4$coefficients[2], SE(model_min_men_4)[2]),
# cbind("Unmet health care\n(mental health)", "All children (lagged wage)",
#       model_min_men_5$coefficients[2], SE(model_min_men_5)[2]),
#
# # Missed 1+ week of school
# cbind("Missed school",    "All children (unadjusted)",
#       model_min_sch_1$coefficients[2], SE(model_min_sch_1)[2]),
# cbind("Missed school",    "All children (adjusted)",
#       model_min_sch_2$coefficients[2], SE(model_min_sch_2)[2]),
# cbind("Missed school",    "Less than 200% FPL",
#       model_min_sch_3$coefficients[2], SE(model_min_sch_3)[2]),
# cbind("Missed school",    "Adults with high school or less",
#       model_min_sch_8$coefficients[2], SE(model_min_sch_8)[2]),
# cbind("Missed school",    "Black or Hispanic/Latino",
#       model_min_sch_7$coefficients[2], SE(model_min_sch_7)[2]),
# cbind("Missed school",    "First- or second-generation",
#       model_min_sch_9$coefficients[2], SE(model_min_sch_9)[2]),
# cbind("Missed school",    "Adolescents, age 13-17",
#       model_min_sch_6$coefficients[2], SE(model_min_sch_6)[2]),
# cbind("Missed school",    "All children (2020 dollars)",
#       model_min_sch_4$coefficients[2], SE(model_min_sch_4)[2]),
# cbind("Missed school",    "All children (lagged wage)",
#       model_min_sch_5$coefficients[2], SE(model_min_sch_5)[2]),
# Child employment
cbind("Child employed",    "All children (unadjusted)",
model_min_job_1$coefficients[2], SE(model_min_job_1)[2]),
cbind("Child employed",    "All children (adjusted)",
model_min_job_2$coefficients[2], SE(model_min_job_2)[2]),
cbind("Child employed",    "Less than 200% FPL",
model_min_job_3$coefficients[2], SE(model_min_job_3)[2]),
cbind("Child employed",    "Adults with high school or less",
model_min_job_8$coefficients[2], SE(model_min_job_8)[2]),
cbind("Child employed",    "Black or Hispanic/Latino",
model_min_job_7$coefficients[2], SE(model_min_job_7)[2]),
cbind("Child employed",    "First- or second-generation",
model_min_job_9$coefficients[2], SE(model_min_job_9)[2]),
cbind("Child employed",    "Adolescents, age 13-17",
model_min_job_6$coefficients[2], SE(model_min_job_6)[2]),
cbind("Child employed",    "All children (2020 dollars)",
model_min_job_4$coefficients[2], SE(model_min_job_4)[2]),
cbind("Child employed",    "All children (lagged wage)",
model_min_job_5$coefficients[2], SE(model_min_job_5)[2])
))
colnames(main_vals) <- c("Outcome", "Sample", "effect", "se")
# Reorder factor variables
main_vals$Outcome <- factor(main_vals$Outcome, levels=c("Depression", "Anxiety", "ADD/ADHD", "Behavioral prob.", "Digestive issues", "Unmet health care\n(of any kind)", "Unmet health care\n(mental health)", "Missed school", "Child employed"))
main_vals$Sample <- factor(main_vals$Sample, levels=c("All children (unadjusted)", "All children (adjusted)", "Less than 200% FPL", "Adults with high school or less", "Black or Hispanic/Latino", "First- or second-generation", "Adolescents, age 13-17", "All children (2020 dollars)", "All children (lagged wage)"))
# Treat columns as numeric
main_vals$effect <- as.numeric(main_vals$effect)
main_vals$se     <- as.numeric(main_vals$se)
# Generate coefficient plot
plot_main <- ggplot(main_vals, aes(x=Outcome, y=effect,
group=Sample, color=Sample)) +
geom_point(position = position_dodge(width=0.6), size=1, aes(shape=Sample)) +
scale_shape_manual(values = 1:nlevels(main_vals$Sample)) +
geom_errorbar(aes(ymin=effect-1.96*se, ymax=effect+1.96*se),
position = position_dodge(width=0.6), width=0.4) +
ylab("Effect of $1 increase in minimum wage\non mental health outcomes") +
theme_test() +
theme(legend.position = "right",
text = element_text(size = 10, face = "bold"),
axis.text.x = element_text(angle=45, hjust=1, vjust=1),
axis.title.x = element_blank(),
axis.ticks = element_blank(),
strip.background = element_blank(),
legend.title = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color="light gray", linewidth=0.5),
panel.grid.minor.y = element_line(color="light gray", linewidth=0.25)) +
geom_hline(yintercept=0, color="black", linewidth=0.25) +
scale_y_continuous(limits = c(-0.05, 0.05),
breaks = seq(-0.04, 0.04, 0.02),
minor_breaks = seq(-0.05, 0.05, 0.01),
labels = function(x) paste0(x*100," pp")) +
scale_color_grey(start=0, end=0.7)
# Export figure
ggsave(plot=plot_main, file="Coefficient plot, main.pdf", width=4, height=4, units='in', dpi=600)
prop.table(svytable(~fpl_category + child_job, design=design_sub), 1)
test <- svyglm(child_job ~ Effective.Minimum.Wage*age_cat +
age*age_cat + sex*age_cat + race_eth*age_cat + family_struc*age_cat + adult_edu*age_cat + nativity*age_cat +
year*age_cat + fipsst*age_cat,
design = design_sub)
summary(test)
test <- svyglm(child_job ~ Effective.Minimum.Wage*age_cat +
age + sex*age_cat + race_eth*age_cat + family_struc*age_cat + adult_edu*age_cat + nativity*age_cat +
year*age_cat + fipsst*age_cat,
design = design_sub)
summary(test)
