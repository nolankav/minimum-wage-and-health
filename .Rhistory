group=Sample, color=Sample)) +
geom_point(position = position_dodge(width=0.6), size=1, aes(shape=Sample)) +
scale_shape_manual(values = 1:nlevels(interaction_vals$Sample)) +
geom_errorbar(aes(ymin=effect-1.96*se, ymax=effect+1.96*se),
position = position_dodge(width=0.6), width=0.4) +
ylab("Effect of $1 increase in minimum wage\non mental health outcomes") +
theme_test() +
theme(legend.position = "right",
text = element_text(size = 10, face = "bold"),
axis.text.x = element_text(angle=45, hjust=1, vjust=1),
axis.title.x = element_blank(),
axis.ticks = element_blank(),
strip.background = element_blank(),
legend.title = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color="light gray", size=0.5),
panel.grid.minor.y = element_line(color="light gray", size=0.25)) +
geom_hline(yintercept=0, color="black", size=0.25) +
scale_y_continuous(limits = c(-0.025, 0.025),
breaks = c(-0.02, -0.01, 0, 0.01, 0.02),
minor_breaks = seq(-0.02, 0.02, 0.01),
labels = function(x) paste0(x*100," pp")) +
scale_color_grey(start=0, end=0.9)
print(plot_int)
# Generate coefficient plot
plot_int <- ggplot(interaction_vals, aes(x=Outcome, y=effect,
group=Sample, color=Sample)) +
geom_point(position = position_dodge(width=0.6), size=1, aes(shape=Sample)) +
scale_shape_manual(values = 1:nlevels(interaction_vals$Sample)) +
geom_errorbar(aes(ymin=effect-1.96*se, ymax=effect+1.96*se),
position = position_dodge(width=0.6), width=0.4) +
ylab("Effect of $1 increase in minimum wage\non mental health outcomes") +
theme_test() +
theme(legend.position = "right",
text = element_text(size = 10, face = "bold"),
axis.text.x = element_text(angle=45, hjust=1, vjust=1),
axis.title.x = element_blank(),
axis.ticks = element_blank(),
strip.background = element_blank(),
legend.title = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color="light gray", size=0.5),
panel.grid.minor.y = element_line(color="light gray", size=0.25)) +
geom_hline(yintercept=0, color="black", size=0.25) +
scale_y_continuous(limits = c(-0.025, 0.025),
breaks = c(-0.02, -0.01, 0, 0.01, 0.02),
minor_breaks = seq(-0.02, 0.02, 0.01),
labels = function(x) paste0(x*100," pp")) +
scale_color_grey(start=0.2, end=0.9)
print(plot_int)
# Generate coefficient plot
plot_int <- ggplot(interaction_vals, aes(x=Outcome, y=effect,
group=Sample, color=Sample)) +
geom_point(position = position_dodge(width=0.6), size=1, aes(shape=Sample)) +
scale_shape_manual(values = 1:nlevels(interaction_vals$Sample)) +
geom_errorbar(aes(ymin=effect-1.96*se, ymax=effect+1.96*se),
position = position_dodge(width=0.6), width=0.4) +
ylab("Effect of $1 increase in minimum wage\non mental health outcomes") +
theme_test() +
theme(legend.position = "right",
text = element_text(size = 10, face = "bold"),
axis.text.x = element_text(angle=45, hjust=1, vjust=1),
axis.title.x = element_blank(),
axis.ticks = element_blank(),
strip.background = element_blank(),
legend.title = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color="light gray", size=0.5),
panel.grid.minor.y = element_line(color="light gray", size=0.25)) +
geom_hline(yintercept=0, color="black", size=0.25) +
scale_y_continuous(limits = c(-0.025, 0.025),
breaks = c(-0.02, -0.01, 0, 0.01, 0.02),
minor_breaks = seq(-0.02, 0.02, 0.01),
labels = function(x) paste0(x*100," pp")) +
scale_color_grey(start=0.3, end=1)
print(plot_int)
# Generate coefficient plot
plot_int <- ggplot(interaction_vals, aes(x=Outcome, y=effect,
group=Sample, color=Sample)) +
geom_point(position = position_dodge(width=0.6), size=1, aes(shape=Sample)) +
scale_shape_manual(values = 1:nlevels(interaction_vals$Sample)) +
geom_errorbar(aes(ymin=effect-1.96*se, ymax=effect+1.96*se),
position = position_dodge(width=0.6), width=0.4) +
ylab("Effect of $1 increase in minimum wage\non mental health outcomes") +
theme_test() +
theme(legend.position = "right",
text = element_text(size = 10, face = "bold"),
axis.text.x = element_text(angle=45, hjust=1, vjust=1),
axis.title.x = element_blank(),
axis.ticks = element_blank(),
strip.background = element_blank(),
legend.title = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color="light gray", size=0.5),
panel.grid.minor.y = element_line(color="light gray", size=0.25)) +
geom_hline(yintercept=0, color="black", size=0.25) +
scale_y_continuous(limits = c(-0.025, 0.025),
breaks = c(-0.02, -0.01, 0, 0.01, 0.02),
minor_breaks = seq(-0.02, 0.02, 0.01),
labels = function(x) paste0(x*100," pp")) +
scale_color_grey(start=0.5, end=1)
print(plot_int)
# Generate coefficient plot
plot_int <- ggplot(interaction_vals, aes(x=Outcome, y=effect,
group=Sample, color=Sample)) +
geom_point(position = position_dodge(width=0.6), size=1, aes(shape=Sample)) +
scale_shape_manual(values = 1:nlevels(interaction_vals$Sample)) +
geom_errorbar(aes(ymin=effect-1.96*se, ymax=effect+1.96*se),
position = position_dodge(width=0.6), width=0.4) +
ylab("Effect of $1 increase in minimum wage\non mental health outcomes") +
theme_test() +
theme(legend.position = "right",
text = element_text(size = 10, face = "bold"),
axis.text.x = element_text(angle=45, hjust=1, vjust=1),
axis.title.x = element_blank(),
axis.ticks = element_blank(),
strip.background = element_blank(),
legend.title = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color="light gray", size=0.5),
panel.grid.minor.y = element_line(color="light gray", size=0.25)) +
geom_hline(yintercept=0, color="black", size=0.25) +
scale_y_continuous(limits = c(-0.025, 0.025),
breaks = c(-0.02, -0.01, 0, 0.01, 0.02),
minor_breaks = seq(-0.02, 0.02, 0.01),
labels = function(x) paste0(x*100," pp")) +
scale_color_grey(start=0.5, end=0)
print(plot_int)
# Generate coefficient plot
plot_int <- ggplot(interaction_vals, aes(x=Outcome, y=effect,
group=Sample, color=Sample)) +
geom_point(position = position_dodge(width=0.6), size=1, aes(shape=Sample)) +
scale_shape_manual(values = 1:nlevels(interaction_vals$Sample)) +
geom_errorbar(aes(ymin=effect-1.96*se, ymax=effect+1.96*se),
position = position_dodge(width=0.6), width=0.4) +
ylab("Effect of $1 increase in minimum wage\non mental health outcomes") +
theme_test() +
theme(legend.position = "right",
text = element_text(size = 10, face = "bold"),
axis.text.x = element_text(angle=45, hjust=1, vjust=1),
axis.title.x = element_blank(),
axis.ticks = element_blank(),
strip.background = element_blank(),
legend.title = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color="light gray", size=0.5),
panel.grid.minor.y = element_line(color="light gray", size=0.25)) +
geom_hline(yintercept=0, color="black", size=0.25) +
scale_y_continuous(limits = c(-0.025, 0.025),
breaks = c(-0.02, -0.01, 0, 0.01, 0.02),
minor_breaks = seq(-0.02, 0.02, 0.01),
labels = function(x) paste0(x*100," pp")) +
scale_color_grey(start=0, end=0.5)
print(plot_int)
# Generate coefficient plot
plot_int <- ggplot(interaction_vals, aes(x=Outcome, y=effect,
group=Sample, color=Sample)) +
geom_point(position = position_dodge(width=0.6), size=1, aes(shape=Sample)) +
scale_shape_manual(values = 1:nlevels(interaction_vals$Sample)) +
geom_errorbar(aes(ymin=effect-1.96*se, ymax=effect+1.96*se),
position = position_dodge(width=0.6), width=0.4) +
ylab("Effect of $1 increase in minimum wage\non mental health outcomes") +
theme_test() +
theme(legend.position = "right",
text = element_text(size = 10, face = "bold"),
axis.text.x = element_text(angle=45, hjust=1, vjust=1),
axis.title.x = element_blank(),
axis.ticks = element_blank(),
strip.background = element_blank(),
legend.title = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color="light gray", size=0.5),
panel.grid.minor.y = element_line(color="light gray", size=0.25)) +
geom_hline(yintercept=0, color="black", size=0.25) +
scale_y_continuous(limits = c(-0.025, 0.025),
breaks = c(-0.02, -0.01, 0, 0.01, 0.02),
minor_breaks = seq(-0.02, 0.02, 0.01),
labels = function(x) paste0(x*100," pp")) +
scale_color_grey(start=0, end=0.4)
print(plot_int)
# Generate coefficient plot
plot_int <- ggplot(interaction_vals, aes(x=Outcome, y=effect,
group=Sample, color=Sample)) +
geom_point(position = position_dodge(width=0.6), size=1, aes(shape=Sample)) +
scale_shape_manual(values = 1:nlevels(interaction_vals$Sample)) +
geom_errorbar(aes(ymin=effect-1.96*se, ymax=effect+1.96*se),
position = position_dodge(width=0.6), width=0.4) +
ylab("Effect of $1 increase in minimum wage\non mental health outcomes") +
theme_test() +
theme(legend.position = "right",
text = element_text(size = 10, face = "bold"),
axis.text.x = element_text(angle=45, hjust=1, vjust=1),
axis.title.x = element_blank(),
axis.ticks = element_blank(),
strip.background = element_blank(),
legend.title = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color="light gray", size=0.5),
panel.grid.minor.y = element_line(color="light gray", size=0.25)) +
geom_hline(yintercept=0, color="black", size=0.25) +
scale_y_continuous(limits = c(-0.025, 0.025),
breaks = c(-0.02, -0.01, 0, 0.01, 0.02),
minor_breaks = seq(-0.02, 0.02, 0.01),
labels = function(x) paste0(x*100," pp")) +
scale_color_grey(start=0, end=0.3)
print(plot_int)
# Generate coefficient plot
plot_int <- ggplot(interaction_vals, aes(x=Outcome, y=effect,
group=Sample, color=Sample)) +
geom_point(position = position_dodge(width=0.6), size=1, aes(shape=Sample)) +
scale_shape_manual(values = 1:nlevels(interaction_vals$Sample)) +
geom_errorbar(aes(ymin=effect-1.96*se, ymax=effect+1.96*se),
position = position_dodge(width=0.6), width=0.4) +
ylab("Effect of $1 increase in minimum wage\non mental health outcomes") +
theme_test() +
theme(legend.position = "right",
text = element_text(size = 10, face = "bold"),
axis.text.x = element_text(angle=45, hjust=1, vjust=1),
axis.title.x = element_blank(),
axis.ticks = element_blank(),
strip.background = element_blank(),
legend.title = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color="light gray", size=0.5),
panel.grid.minor.y = element_line(color="light gray", size=0.25)) +
geom_hline(yintercept=0, color="black", size=0.25) +
scale_y_continuous(limits = c(-0.025, 0.025),
breaks = c(-0.02, -0.01, 0, 0.01, 0.02),
minor_breaks = seq(-0.02, 0.02, 0.01),
labels = function(x) paste0(x*100," pp")) +
scale_color_grey(start=0, end=0.6)
print(plot_int)
# Generate coefficient plot
plot_int <- ggplot(interaction_vals, aes(x=Outcome, y=effect,
group=Sample, color=Sample)) +
geom_point(position = position_dodge(width=0.6), size=1, aes(shape=Sample)) +
scale_shape_manual(values = 1:nlevels(interaction_vals$Sample)) +
geom_errorbar(aes(ymin=effect-1.96*se, ymax=effect+1.96*se),
position = position_dodge(width=0.6), width=0.4) +
ylab("Effect of $1 increase in minimum wage\non mental health outcomes") +
theme_test() +
theme(legend.position = "right",
text = element_text(size = 10, face = "bold"),
axis.text.x = element_text(angle=45, hjust=1, vjust=1),
axis.title.x = element_blank(),
axis.ticks = element_blank(),
strip.background = element_blank(),
legend.title = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color="light gray", size=0.5),
panel.grid.minor.y = element_line(color="light gray", size=0.25)) +
geom_hline(yintercept=0, color="black", size=0.25) +
scale_y_continuous(limits = c(-0.025, 0.025),
breaks = c(-0.02, -0.01, 0, 0.01, 0.02),
minor_breaks = seq(-0.02, 0.02, 0.01),
labels = function(x) paste0(x*100," pp")) +
scale_color_grey(start=0, end=0.7)
print(plot_int)
# Generate coefficient plot
plot_int <- ggplot(interaction_vals, aes(x=Outcome, y=effect,
group=Sample, color=Sample)) +
geom_point(position = position_dodge(width=0.6), size=1, aes(shape=Sample)) +
scale_shape_manual(values = 1:nlevels(interaction_vals$Sample)) +
geom_errorbar(aes(ymin=effect-1.96*se, ymax=effect+1.96*se),
position = position_dodge(width=0.6), width=0.4) +
ylab("Effect of $1 increase in minimum wage\non mental health outcomes") +
theme_test() +
theme(legend.position = "right",
text = element_text(size = 10, face = "bold"),
axis.text.x = element_text(angle=45, hjust=1, vjust=1),
axis.title.x = element_blank(),
axis.ticks = element_blank(),
strip.background = element_blank(),
legend.title = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color="light gray", size=0.5),
panel.grid.minor.y = element_line(color="light gray", size=0.25)) +
geom_hline(yintercept=0, color="black", size=0.25) +
scale_y_continuous(limits = c(-0.025, 0.025),
breaks = c(-0.02, -0.01, 0, 0.01, 0.02),
minor_breaks = seq(-0.02, 0.02, 0.01),
labels = function(x) paste0(x*100," pp")) +
scale_color_grey(start=0, end=0.6)
print(plot_int)
# Export figure
ggsave(plot=plot_int, file="Coefficient plot.pdf", width=6.5, height=4, units='in', dpi=600)
# Generate coefficient plot
plot_int <- ggplot(interaction_vals, aes(x=Outcome, y=effect,
group=Sample, color=Sample)) +
geom_point(position = position_dodge(width=0.6), size=1, aes(shape=Sample)) +
scale_shape_manual(values = 1:nlevels(interaction_vals$Sample)) +
geom_errorbar(aes(ymin=effect-1.96*se, ymax=effect+1.96*se),
position = position_dodge(width=0.6), width=0.4) +
ylab("Effect of $1 increase in minimum wage\non mental health outcomes") +
theme_test() +
theme(legend.position = "right",
text = element_text(size = 10, face = "bold"),
axis.text.x = element_text(angle=45, hjust=1, vjust=1),
axis.title.x = element_blank(),
axis.ticks = element_blank(),
strip.background = element_blank(),
legend.title = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.major.y = element_line(color="light gray", size=0.5),
panel.grid.minor.y = element_line(color="light gray", size=0.25)) +
geom_hline(yintercept=0, color="black", size=0.25) +
scale_y_continuous(limits = c(-0.025, 0.025),
breaks = c(-0.02, -0.01, 0, 0.01, 0.02),
minor_breaks = seq(-0.02, 0.02, 0.01),
labels = function(x) paste0(x*100," pp")) +
scale_color_grey(start=0, end=0.7)
# Export figure
ggsave(plot=plot_int, file="Coefficient plot.pdf", width=6.5, height=4, units='in', dpi=600)
cor.test(merged$Effective.Minimum.Wage, merged$lag_by_1)
svyby(~fpl_category + sex + depression,    design=design_sub)
svyby(depression~fpl_category + sex,    design=design_sub)
svyby(~depression, ~fpl_category + sex, design_sub, svymean, na.rm=T)
model_min_dep$coefficients[2]
# Models for depression
model_min_dep <- svyglm(depression ~ Effective.Minimum.Wage +
age + sex + race + ethnicity + adult_edu + fpl_category +
year + fipsst,
design = design_sub)
# Child characteristics: weighted
# This line provides demographic characteristics with survey weights.
summary(tableby(~ age + sex + race + ethnicity + adult_edu + fpl_category + year,
merged_demo, digits.pct=0, weights=fwc/2097), text=T)
# Clear R environment
rm(list = ls())
# Load packages
library(here)         # Working directory
library(readstata13)  # Dataset tools
library(dplyr)        # Analysis tools
library(psych)        # Analysis tools
library(modelbased)   # Modeling tools
library(survey)       # Survey tools
library(ggplot2)      # Graphing tools
library(usmap)        # Graphing tools
library(viridis)      # Graphing tools
library(cowplot)      # Graphing tools
library(scales)       # Graphing tools
library(arsenal)      # Table tools
library(modelsummary) # Table tools
library(kableExtra)   # Table tools
library(cdlTools)     # FIPS tools
##############################################################################
# Dataset preparation
##############################################################################
# Read NSCH datasets into R
nsch_2016_top <- read.dta13("NSCH data/nsch_2016_topical.dta")
nsch_2017_top <- read.dta13("NSCH data/nsch_2017_topical.dta")
nsch_2018_top <- read.dta13("NSCH data/nsch_2018_topical.dta")
nsch_2019_top <- read.dta13("NSCH data/nsch_2019_topical.dta")
nsch_2020_top <- read.dta13("NSCH data/nsch_2020_topical.dta")
nsch_2021_top <- read.dta13("NSCH data/nsch_2021_topical.dta")
# Treat stratum as character
# Necessary for a smooth merge
nsch_2016_top$stratum <- as.character(nsch_2016_top$stratum)
# Bind all survey years together
nsch_all <- bind_rows(nsch_2016_top, nsch_2017_top, nsch_2018_top,
nsch_2019_top, nsch_2020_top, nsch_2021_top)
# Redefine strata
# Recommended by the NSCH for multi-year analyses
nsch_all <- nsch_all %>% mutate(
strata = case_when(
stratum %in% c("1")       ~ "1",
stratum %in% c("2", "2A") ~ "2"
))
# Read minimum wage dataset into R
min_wage_df <- read.csv("https://raw.githubusercontent.com/Lislejoem/Minimum-Wage-by-State-1968-to-2020/master/Minimum%20Wage%20Data.csv")
# Convert state names to FIPS
# Necessary for a smooth merge
min_wage_df$fipsst <- cdlTools::fips(min_wage_df$State, to="FIPS")
# Generate new year variable
min_wage_df$year <- min_wage_df$Year
# Reorder dataset
min_wage_df <- min_wage_df %>% arrange(fipsst, year)
# Generate lagged minimum wage
min_wage_df <- min_wage_df %>%
group_by(fipsst) %>%
mutate(lag_by_1 = lag(Effective.Minimum.Wage, n=1, default=NA))
# Merge minimum wage and NSCH data
merged <- left_join(nsch_all, min_wage_df, by=c("fipsst", "year"))
# Clear old datasets from R
rm(nsch_2016_top, nsch_2017_top, nsch_2018_top,
nsch_2019_top, nsch_2020_top, nsch_2021_top)
##############################################################################
# Variable preparation
##############################################################################
# Treat fixed effects as factors
merged$year   <- as.factor(merged$year)
merged$fipsst <- as.factor(merged$fipsst)
# Child's age
merged <- merged %>% mutate(
age = case_when(
sc_age_years %in% c(0:17) ~ sc_age_years
))
# Dichotomize age for interaction models
merged <- merged %>% mutate(
age_cat = case_when(
sc_age_years %in% c(0:12)  ~ "Children",
sc_age_years %in% c(13:17) ~ "Adolescents"
))
merged$age_cat <- factor(merged$age_cat, levels = c("Adolescents", "Children"))
# Child's sex
merged <- merged %>% mutate(
sex = case_when(
sc_sex == 1 ~ "Male",
sc_sex == 2 ~ "Female"
))
merged$sex <- factor(merged$sex, levels = c("Male", "Female"))
# Child's race/ethnicity
merged <- merged %>% mutate(
race_eth = case_when(
sc_hispanic_r == 1    ~ "Hispanic/Latino",
sc_race_r == 1        ~ "White, non-Hispanic/Latino",
sc_race_r == 2        ~ "Black, non-Hispanic/Latino",
sc_race_r == 3        ~ "American Indian or Alaska Native",
sc_race_r %in% c(4:5) ~ "Asian, Native Hawaiian, or Pacific Islander",
sc_race_r %in% c(6:7) ~ "Other or mixed race",
))
merged$race_eth <- factor(merged$race_eth, levels = c("White, non-Hispanic/Latino", "Black, non-Hispanic/Latino", "Hispanic/Latino", "American Indian or Alaska Native", "Asian, Native Hawaiian, or Pacific Islander", "Other or mixed race"))
# Dichotomoize race/ethnicity
# White vs. non-white for interaction models
merged <- merged %>% mutate(
race_eth_cat = case_when(
sc_hispanic_r == 1    ~ "Non-white",
sc_race_r == 1        ~ "White",
sc_race_r %in% c(2:7) ~ "Non-white",
))
merged$race_eth_cat <- factor(merged$race_eth_cat, levels = c("Non-white", "White"))
# Adults' highest educational attainment
merged <- merged %>% mutate(
adult_edu = case_when(
higrade_tvis == 1 ~ "Less than high school",
higrade_tvis == 2 ~ "High school (including vocational)",
higrade_tvis == 3 ~ "Some college or associate degree",
higrade_tvis == 4 ~ "College degree or higher"
))
merged$adult_edu <- factor(merged$adult_edu, levels = c("Less than high school", "High school (including vocational)", "Some college or associate degree", "College degree or higher"))
# Generate mean estimated FPL
# Later NSCH years generated 6 imputed FPLs if a household was missing income
merged$fpl_mean <- rowMeans(cbind(merged$fpl_i1, merged$fpl_i2, merged$fpl_i3,
merged$fpl_i4, merged$fpl_i5, merged$fpl_i6), na.rm=T)
# Household's federal poverty level
merged <- merged %>% mutate(
fpl_category = case_when(
fpl %in% c(50:99)   | fpl_mean < 100 ~ "Less than 100%",
fpl %in% c(100:199) | fpl_mean < 200 ~ "100% to 199%",
fpl %in% c(200:299) | fpl_mean < 300 ~ "200% to 299%",
fpl %in% c(300:399) | fpl_mean < 400 ~ "300% to 399%",
fpl %in% c(400:999) | fpl_mean < 999 ~ "400% or greater"
))
merged$fpl_category <- factor(merged$fpl_category, levels = c("Less than 100%", "100% to 199%", "200% to 299%", "300% to 399%", "400% or greater"))
# Dichotomize FPL for interaction models
# Low-income (<200% FPL) vs. higher-income
merged <- merged %>% mutate(
low_income = case_when(
fpl %in% c(50:199)  | fpl_mean < 200 ~ "Lower-income",
fpl %in% c(200:999) | fpl_mean < 999 ~ "Higher-income"
))
merged$low_income <- factor(merged$low_income, levels = c("Lower-income", "Higher-income"))
# Current dignosed depression
merged <- merged %>% mutate(
depression = case_when(
k2q32b %in% c(1)                      ~ 1,
k2q32b %in% c(2) | k2q32a %in% c(1:2) ~ 0
))
# Current diagnosed anxiety
merged <- merged %>% mutate(
anxiety = case_when(
k2q33b %in% c(1)                      ~ 1,
k2q33b %in% c(2) | k2q33a %in% c(1:2) ~ 0
))
# Current behavior problems
merged <- merged %>% mutate(
behavior = case_when(
k2q34b %in% c(1)                      ~ 1,
k2q34b %in% c(2) | k2q34a %in% c(1:2) ~ 0
))
# Stomach/digestive issues
merged <- merged %>% mutate(
stomach_r = case_when(
stomach %in% c(1) ~ 1,
stomach %in% c(2) ~ 0
))
# Missed days of school
# Dichotomize is as 0-6 vs 7+ days
merged <- merged %>% mutate(
missed_school = case_when(
k7q02r_r %in% c(1:3) ~ 0,
k7q02r_r %in% c(4:5) ~ 1
))
# At least 1 outcome
merged <- merged %>% mutate(
has_outcome = case_when(
!is.na(depression) | !is.na(anxiety) | !is.na(behavior) |
!is.na(stomach_r) | !is.na(missed_school) ~ 1
))
# Complete cases for covariates
merged_demo <- merged %>%
subset(., age %in% c(3:17)) %>%
filter_at(vars(Effective.Minimum.Wage, has_outcome, age, sex, race_eth,
adult_edu, fpl_category), all_vars(!is.na(.)))
# Child characteristics: unweighted
# This line provides demographic characteristics without survey weights.
summary(tableby(~ age + sex + race_eth + adult_edu + fpl_category + year,
merged_demo, digits.pct=0), text=T)
# Child characteristics: weighted
# This line provides demographic characteristics with survey weights.
summary(tableby(~ age + sex + race_eth + adult_edu + fpl_category + year,
merged_demo, digits.pct=0, weights=fwc/1946), text=T)
